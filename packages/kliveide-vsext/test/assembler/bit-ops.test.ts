import "mocha";
import { codeRaisesError, testCodeEmit } from "./test-helpers";

describe("Assembler - bit operations", () => {
  it("bit", () => {
    testCodeEmit("bit 0,b", 0xcb, 0x40);
    testCodeEmit("bit 0,c", 0xcb, 0x41);
    testCodeEmit("bit 0,d", 0xcb, 0x42);
    testCodeEmit("bit 0,e", 0xcb, 0x43);
    testCodeEmit("bit 0,h", 0xcb, 0x44);
    testCodeEmit("bit 0,l", 0xcb, 0x45);
    testCodeEmit("bit 0,(hl)", 0xcb, 0x46);
    testCodeEmit("bit 0,a", 0xcb, 0x47);

    testCodeEmit("bit 1,b", 0xcb, 0x48);
    testCodeEmit("bit 1,c", 0xcb, 0x49);
    testCodeEmit("bit 1,d", 0xcb, 0x4a);
    testCodeEmit("bit 1,e", 0xcb, 0x4b);
    testCodeEmit("bit 1,h", 0xcb, 0x4c);
    testCodeEmit("bit 1,l", 0xcb, 0x4d);
    testCodeEmit("bit 1,(hl)", 0xcb, 0x4e);
    testCodeEmit("bit 1,a", 0xcb, 0x4f);

    testCodeEmit("bit 2,b", 0xcb, 0x50);
    testCodeEmit("bit 2,c", 0xcb, 0x51);
    testCodeEmit("bit 2,d", 0xcb, 0x52);
    testCodeEmit("bit 2,e", 0xcb, 0x53);
    testCodeEmit("bit 2,h", 0xcb, 0x54);
    testCodeEmit("bit 2,l", 0xcb, 0x55);
    testCodeEmit("bit 2,(hl)", 0xcb, 0x56);
    testCodeEmit("bit 2,a", 0xcb, 0x57);

    testCodeEmit("bit 3,b", 0xcb, 0x58);
    testCodeEmit("bit 3,c", 0xcb, 0x59);
    testCodeEmit("bit 3,d", 0xcb, 0x5a);
    testCodeEmit("bit 3,e", 0xcb, 0x5b);
    testCodeEmit("bit 3,h", 0xcb, 0x5c);
    testCodeEmit("bit 3,l", 0xcb, 0x5d);
    testCodeEmit("bit 3,(hl)", 0xcb, 0x5e);
    testCodeEmit("bit 3,a", 0xcb, 0x5f);

    testCodeEmit("bit 4,b", 0xcb, 0x60);
    testCodeEmit("bit 4,c", 0xcb, 0x61);
    testCodeEmit("bit 4,d", 0xcb, 0x62);
    testCodeEmit("bit 4,e", 0xcb, 0x63);
    testCodeEmit("bit 4,h", 0xcb, 0x64);
    testCodeEmit("bit 4,l", 0xcb, 0x65);
    testCodeEmit("bit 4,(hl)", 0xcb, 0x66);
    testCodeEmit("bit 4,a", 0xcb, 0x67);

    testCodeEmit("bit 5,b", 0xcb, 0x68);
    testCodeEmit("bit 5,c", 0xcb, 0x69);
    testCodeEmit("bit 5,d", 0xcb, 0x6a);
    testCodeEmit("bit 5,e", 0xcb, 0x6b);
    testCodeEmit("bit 5,h", 0xcb, 0x6c);
    testCodeEmit("bit 5,l", 0xcb, 0x6d);
    testCodeEmit("bit 5,(hl)", 0xcb, 0x6e);
    testCodeEmit("bit 5,a", 0xcb, 0x6f);

    testCodeEmit("bit 6,b", 0xcb, 0x70);
    testCodeEmit("bit 6,c", 0xcb, 0x71);
    testCodeEmit("bit 6,d", 0xcb, 0x72);
    testCodeEmit("bit 6,e", 0xcb, 0x73);
    testCodeEmit("bit 6,h", 0xcb, 0x74);
    testCodeEmit("bit 6,l", 0xcb, 0x75);
    testCodeEmit("bit 6,(hl)", 0xcb, 0x76);
    testCodeEmit("bit 6,a", 0xcb, 0x77);

    testCodeEmit("bit 7,b", 0xcb, 0x78);
    testCodeEmit("bit 7,c", 0xcb, 0x79);
    testCodeEmit("bit 7,d", 0xcb, 0x7a);
    testCodeEmit("bit 7,e", 0xcb, 0x7b);
    testCodeEmit("bit 7,h", 0xcb, 0x7c);
    testCodeEmit("bit 7,l", 0xcb, 0x7d);
    testCodeEmit("bit 7,(hl)", 0xcb, 0x7e);
    testCodeEmit("bit 7,a", 0xcb, 0x7f);
  });

  it("bit: fails with invalid operand", () => {
    codeRaisesError("bit -1,b", "Z2049");
    codeRaisesError("bit 8,b", "Z2049");
  });

  it("bit: indexed instructions", () => {
    testCodeEmit("bit 0,(ix)", 0xdd, 0xcb, 0x00, 0x46);
    testCodeEmit("bit 0,(ix+6)", 0xdd, 0xcb, 0x06, 0x46);
    testCodeEmit("bit 0,(ix-#0c)", 0xdd, 0xcb, 0xf4, 0x46);
    testCodeEmit("bit 1,(ix)", 0xdd, 0xcb, 0x00, 0x4e);
    testCodeEmit("bit 1,(ix+6)", 0xdd, 0xcb, 0x06, 0x4e);
    testCodeEmit("bit 1,(ix-#0c)", 0xdd, 0xcb, 0xf4, 0x4e);
    testCodeEmit("bit 2,(ix)", 0xdd, 0xcb, 0x00, 0x56);
    testCodeEmit("bit 2,(ix+6)", 0xdd, 0xcb, 0x06, 0x56);
    testCodeEmit("bit 2,(ix-#0c)", 0xdd, 0xcb, 0xf4, 0x56);
    testCodeEmit("bit 3,(ix)", 0xdd, 0xcb, 0x00, 0x5e);
    testCodeEmit("bit 3,(ix+6)", 0xdd, 0xcb, 0x06, 0x5e);
    testCodeEmit("bit 3,(ix-#0c)", 0xdd, 0xcb, 0xf4, 0x5e);
    testCodeEmit("bit 4,(ix)", 0xdd, 0xcb, 0x00, 0x66);
    testCodeEmit("bit 4,(ix+6)", 0xdd, 0xcb, 0x06, 0x66);
    testCodeEmit("bit 4,(ix-#0c)", 0xdd, 0xcb, 0xf4, 0x66);
    testCodeEmit("bit 5,(ix)", 0xdd, 0xcb, 0x00, 0x6e);
    testCodeEmit("bit 5,(ix+6)", 0xdd, 0xcb, 0x06, 0x6e);
    testCodeEmit("bit 5,(ix-#0c)", 0xdd, 0xcb, 0xf4, 0x6e);
    testCodeEmit("bit 6,(ix)", 0xdd, 0xcb, 0x00, 0x76);
    testCodeEmit("bit 6,(ix+6)", 0xdd, 0xcb, 0x06, 0x76);
    testCodeEmit("bit 6,(ix-#0c)", 0xdd, 0xcb, 0xf4, 0x76);
    testCodeEmit("bit 7,(ix)", 0xdd, 0xcb, 0x00, 0x7e);
    testCodeEmit("bit 7,(ix+6)", 0xdd, 0xcb, 0x06, 0x7e);
    testCodeEmit("bit 7,(ix-#0c)", 0xdd, 0xcb, 0xf4, 0x7e);
    testCodeEmit("bit 0,(iy)", 0xfd, 0xcb, 0x00, 0x46);
    testCodeEmit("bit 0,(iy+6)", 0xfd, 0xcb, 0x06, 0x46);
    testCodeEmit("bit 0,(iy-#0c)", 0xfd, 0xcb, 0xf4, 0x46);
    testCodeEmit("bit 1,(iy)", 0xfd, 0xcb, 0x00, 0x4e);
    testCodeEmit("bit 1,(iy+6)", 0xfd, 0xcb, 0x06, 0x4e);
    testCodeEmit("bit 1,(iy-#0c)", 0xfd, 0xcb, 0xf4, 0x4e);
    testCodeEmit("bit 2,(iy)", 0xfd, 0xcb, 0x00, 0x56);
    testCodeEmit("bit 2,(iy+6)", 0xfd, 0xcb, 0x06, 0x56);
    testCodeEmit("bit 2,(iy-#0c)", 0xfd, 0xcb, 0xf4, 0x56);
    testCodeEmit("bit 3,(iy)", 0xfd, 0xcb, 0x00, 0x5e);
    testCodeEmit("bit 3,(iy+6)", 0xfd, 0xcb, 0x06, 0x5e);
    testCodeEmit("bit 3,(iy-#0c)", 0xfd, 0xcb, 0xf4, 0x5e);
    testCodeEmit("bit 4,(iy)", 0xfd, 0xcb, 0x00, 0x66);
    testCodeEmit("bit 4,(iy+6)", 0xfd, 0xcb, 0x06, 0x66);
    testCodeEmit("bit 4,(iy-#0c)", 0xfd, 0xcb, 0xf4, 0x66);
    testCodeEmit("bit 5,(iy)", 0xfd, 0xcb, 0x00, 0x6e);
    testCodeEmit("bit 5,(iy+6)", 0xfd, 0xcb, 0x06, 0x6e);
    testCodeEmit("bit 5,(iy-#0c)", 0xfd, 0xcb, 0xf4, 0x6e);
    testCodeEmit("bit 6,(iy)", 0xfd, 0xcb, 0x00, 0x76);
    testCodeEmit("bit 6,(iy+6)", 0xfd, 0xcb, 0x06, 0x76);
    testCodeEmit("bit 6,(iy-#0c)", 0xfd, 0xcb, 0xf4, 0x76);
    testCodeEmit("bit 7,(iy)", 0xfd, 0xcb, 0x00, 0x7e);
    testCodeEmit("bit 7,(iy+6)", 0xfd, 0xcb, 0x06, 0x7e);
    testCodeEmit("bit 7,(iy-#0c)", 0xfd, 0xcb, 0xf4, 0x7e);
  });

  it("res", () => {
    testCodeEmit("res 0,b", 0xcb, 0x80);
    testCodeEmit("res 0,c", 0xcb, 0x81);
    testCodeEmit("res 0,d", 0xcb, 0x82);
    testCodeEmit("res 0,e", 0xcb, 0x83);
    testCodeEmit("res 0,h", 0xcb, 0x84);
    testCodeEmit("res 0,l", 0xcb, 0x85);
    testCodeEmit("res 0,(hl)", 0xcb, 0x86);
    testCodeEmit("res 0,a", 0xcb, 0x87);

    testCodeEmit("res 1,b", 0xcb, 0x88);
    testCodeEmit("res 1,c", 0xcb, 0x89);
    testCodeEmit("res 1,d", 0xcb, 0x8a);
    testCodeEmit("res 1,e", 0xcb, 0x8b);
    testCodeEmit("res 1,h", 0xcb, 0x8c);
    testCodeEmit("res 1,l", 0xcb, 0x8d);
    testCodeEmit("res 1,(hl)", 0xcb, 0x8e);
    testCodeEmit("res 1,a", 0xcb, 0x8f);

    testCodeEmit("res 2,b", 0xcb, 0x90);
    testCodeEmit("res 2,c", 0xcb, 0x91);
    testCodeEmit("res 2,d", 0xcb, 0x92);
    testCodeEmit("res 2,e", 0xcb, 0x93);
    testCodeEmit("res 2,h", 0xcb, 0x94);
    testCodeEmit("res 2,l", 0xcb, 0x95);
    testCodeEmit("res 2,(hl)", 0xcb, 0x96);
    testCodeEmit("res 2,a", 0xcb, 0x97);

    testCodeEmit("res 3,b", 0xcb, 0x98);
    testCodeEmit("res 3,c", 0xcb, 0x99);
    testCodeEmit("res 3,d", 0xcb, 0x9a);
    testCodeEmit("res 3,e", 0xcb, 0x9b);
    testCodeEmit("res 3,h", 0xcb, 0x9c);
    testCodeEmit("res 3,l", 0xcb, 0x9d);
    testCodeEmit("res 3,(hl)", 0xcb, 0x9e);
    testCodeEmit("res 3,a", 0xcb, 0x9f);

    testCodeEmit("res 4,b", 0xcb, 0xa0);
    testCodeEmit("res 4,c", 0xcb, 0xa1);
    testCodeEmit("res 4,d", 0xcb, 0xa2);
    testCodeEmit("res 4,e", 0xcb, 0xa3);
    testCodeEmit("res 4,h", 0xcb, 0xa4);
    testCodeEmit("res 4,l", 0xcb, 0xa5);
    testCodeEmit("res 4,(hl)", 0xcb, 0xa6);
    testCodeEmit("res 4,a", 0xcb, 0xa7);

    testCodeEmit("res 5,b", 0xcb, 0xa8);
    testCodeEmit("res 5,c", 0xcb, 0xa9);
    testCodeEmit("res 5,d", 0xcb, 0xaa);
    testCodeEmit("res 5,e", 0xcb, 0xab);
    testCodeEmit("res 5,h", 0xcb, 0xac);
    testCodeEmit("res 5,l", 0xcb, 0xad);
    testCodeEmit("res 5,(hl)", 0xcb, 0xae);
    testCodeEmit("res 5,a", 0xcb, 0xaf);

    testCodeEmit("res 6,b", 0xcb, 0xb0);
    testCodeEmit("res 6,c", 0xcb, 0xb1);
    testCodeEmit("res 6,d", 0xcb, 0xb2);
    testCodeEmit("res 6,e", 0xcb, 0xb3);
    testCodeEmit("res 6,h", 0xcb, 0xb4);
    testCodeEmit("res 6,l", 0xcb, 0xb5);
    testCodeEmit("res 6,(hl)", 0xcb, 0xb6);
    testCodeEmit("res 6,a", 0xcb, 0xb7);

    testCodeEmit("res 7,b", 0xcb, 0xb8);
    testCodeEmit("res 7,c", 0xcb, 0xb9);
    testCodeEmit("res 7,d", 0xcb, 0xba);
    testCodeEmit("res 7,e", 0xcb, 0xbb);
    testCodeEmit("res 7,h", 0xcb, 0xbc);
    testCodeEmit("res 7,l", 0xcb, 0xbd);
    testCodeEmit("res 7,(hl)", 0xcb, 0xbe);
    testCodeEmit("res 7,a", 0xcb, 0xbf);
  });

  it("res: fails with invalid operand", () => {
    codeRaisesError("res -1,b", "Z2049");
    codeRaisesError("res 8,b", "Z2049");
  });

  it("res: indexed instructions", () => {
    testCodeEmit("res 0,(ix),b", 0xdd, 0xcb, 0x00, 0x80);
    testCodeEmit("res 0,(ix+6),b", 0xdd, 0xcb, 0x06, 0x80);
    testCodeEmit("res 0,(ix-#0c),b", 0xdd, 0xcb, 0xf4, 0x80);
    testCodeEmit("res 0,(ix),c", 0xdd, 0xcb, 0x00, 0x81);
    testCodeEmit("res 0,(ix+6),c", 0xdd, 0xcb, 0x06, 0x81);
    testCodeEmit("res 0,(ix-#0c),c", 0xdd, 0xcb, 0xf4, 0x81);
    testCodeEmit("res 0,(ix),d", 0xdd, 0xcb, 0x00, 0x82);
    testCodeEmit("res 0,(ix+6),d", 0xdd, 0xcb, 0x06, 0x82);
    testCodeEmit("res 0,(ix-#0c),d", 0xdd, 0xcb, 0xf4, 0x82);
    testCodeEmit("res 0,(ix),e", 0xdd, 0xcb, 0x00, 0x83);
    testCodeEmit("res 0,(ix+6),e", 0xdd, 0xcb, 0x06, 0x83);
    testCodeEmit("res 0,(ix-#0c),e", 0xdd, 0xcb, 0xf4, 0x83);
    testCodeEmit("res 0,(ix),h", 0xdd, 0xcb, 0x00, 0x84);
    testCodeEmit("res 0,(ix+6),h", 0xdd, 0xcb, 0x06, 0x84);
    testCodeEmit("res 0,(ix-#0c),h", 0xdd, 0xcb, 0xf4, 0x84);
    testCodeEmit("res 0,(ix),l", 0xdd, 0xcb, 0x00, 0x85);
    testCodeEmit("res 0,(ix+6),l", 0xdd, 0xcb, 0x06, 0x85);
    testCodeEmit("res 0,(ix-#0c),l", 0xdd, 0xcb, 0xf4, 0x85);
    testCodeEmit("res 0,(ix)", 0xdd, 0xcb, 0x00, 0x86);
    testCodeEmit("res 0,(ix+6)", 0xdd, 0xcb, 0x06, 0x86);
    testCodeEmit("res 0,(ix-#0c)", 0xdd, 0xcb, 0xf4, 0x86);
    testCodeEmit("res 0,(ix),a", 0xdd, 0xcb, 0x00, 0x87);
    testCodeEmit("res 0,(ix+6),a", 0xdd, 0xcb, 0x06, 0x87);
    testCodeEmit("res 0,(ix-#0c),a", 0xdd, 0xcb, 0xf4, 0x87);

    testCodeEmit("res 1,(ix),b", 0xdd, 0xcb, 0x00, 0x88);
    testCodeEmit("res 1,(ix+6),b", 0xdd, 0xcb, 0x06, 0x88);
    testCodeEmit("res 1,(ix-#0c),b", 0xdd, 0xcb, 0xf4, 0x88);
    testCodeEmit("res 1,(ix),c", 0xdd, 0xcb, 0x00, 0x89);
    testCodeEmit("res 1,(ix+6),c", 0xdd, 0xcb, 0x06, 0x89);
    testCodeEmit("res 1,(ix-#0c),c", 0xdd, 0xcb, 0xf4, 0x89);
    testCodeEmit("res 1,(ix),d", 0xdd, 0xcb, 0x00, 0x8a);
    testCodeEmit("res 1,(ix+6),d", 0xdd, 0xcb, 0x06, 0x8a);
    testCodeEmit("res 1,(ix-#0c),d", 0xdd, 0xcb, 0xf4, 0x8a);
    testCodeEmit("res 1,(ix),e", 0xdd, 0xcb, 0x00, 0x8b);
    testCodeEmit("res 1,(ix+6),e", 0xdd, 0xcb, 0x06, 0x8b);
    testCodeEmit("res 1,(ix-#0c),e", 0xdd, 0xcb, 0xf4, 0x8b);
    testCodeEmit("res 1,(ix),h", 0xdd, 0xcb, 0x00, 0x8c);
    testCodeEmit("res 1,(ix+6),h", 0xdd, 0xcb, 0x06, 0x8c);
    testCodeEmit("res 1,(ix-#0c),h", 0xdd, 0xcb, 0xf4, 0x8c);
    testCodeEmit("res 1,(ix),l", 0xdd, 0xcb, 0x00, 0x8d);
    testCodeEmit("res 1,(ix+6),l", 0xdd, 0xcb, 0x06, 0x8d);
    testCodeEmit("res 1,(ix-#0c),l", 0xdd, 0xcb, 0xf4, 0x8d);
    testCodeEmit("res 1,(ix)", 0xdd, 0xcb, 0x00, 0x8e);
    testCodeEmit("res 1,(ix+6)", 0xdd, 0xcb, 0x06, 0x8e);
    testCodeEmit("res 1,(ix-#0c)", 0xdd, 0xcb, 0xf4, 0x8e);
    testCodeEmit("res 1,(ix),a", 0xdd, 0xcb, 0x00, 0x8f);
    testCodeEmit("res 1,(ix+6),a", 0xdd, 0xcb, 0x06, 0x8f);
    testCodeEmit("res 1,(ix-#0c),a", 0xdd, 0xcb, 0xf4, 0x8f);

    testCodeEmit("res 2,(ix),b", 0xdd, 0xcb, 0x00, 0x90);
    testCodeEmit("res 2,(ix+6),b", 0xdd, 0xcb, 0x06, 0x90);
    testCodeEmit("res 2,(ix-#0c),b", 0xdd, 0xcb, 0xf4, 0x90);
    testCodeEmit("res 2,(ix),c", 0xdd, 0xcb, 0x00, 0x91);
    testCodeEmit("res 2,(ix+6),c", 0xdd, 0xcb, 0x06, 0x91);
    testCodeEmit("res 2,(ix-#0c),c", 0xdd, 0xcb, 0xf4, 0x91);
    testCodeEmit("res 2,(ix),d", 0xdd, 0xcb, 0x00, 0x92);
    testCodeEmit("res 2,(ix+6),d", 0xdd, 0xcb, 0x06, 0x92);
    testCodeEmit("res 2,(ix-#0c),d", 0xdd, 0xcb, 0xf4, 0x92);
    testCodeEmit("res 2,(ix),e", 0xdd, 0xcb, 0x00, 0x93);
    testCodeEmit("res 2,(ix+6),e", 0xdd, 0xcb, 0x06, 0x93);
    testCodeEmit("res 2,(ix-#0c),e", 0xdd, 0xcb, 0xf4, 0x93);
    testCodeEmit("res 2,(ix),h", 0xdd, 0xcb, 0x00, 0x94);
    testCodeEmit("res 2,(ix+6),h", 0xdd, 0xcb, 0x06, 0x94);
    testCodeEmit("res 2,(ix-#0c),h", 0xdd, 0xcb, 0xf4, 0x94);
    testCodeEmit("res 2,(ix),l", 0xdd, 0xcb, 0x00, 0x95);
    testCodeEmit("res 2,(ix+6),l", 0xdd, 0xcb, 0x06, 0x95);
    testCodeEmit("res 2,(ix-#0c),l", 0xdd, 0xcb, 0xf4, 0x95);
    testCodeEmit("res 2,(ix)", 0xdd, 0xcb, 0x00, 0x96);
    testCodeEmit("res 2,(ix+6)", 0xdd, 0xcb, 0x06, 0x96);
    testCodeEmit("res 2,(ix-#0c)", 0xdd, 0xcb, 0xf4, 0x96);
    testCodeEmit("res 2,(ix),a", 0xdd, 0xcb, 0x00, 0x97);
    testCodeEmit("res 2,(ix+6),a", 0xdd, 0xcb, 0x06, 0x97);
    testCodeEmit("res 2,(ix-#0c),a", 0xdd, 0xcb, 0xf4, 0x97);

    testCodeEmit("res 3,(ix),b", 0xdd, 0xcb, 0x00, 0x98);
    testCodeEmit("res 3,(ix+6),b", 0xdd, 0xcb, 0x06, 0x98);
    testCodeEmit("res 3,(ix-#0c),b", 0xdd, 0xcb, 0xf4, 0x98);
    testCodeEmit("res 3,(ix),c", 0xdd, 0xcb, 0x00, 0x99);
    testCodeEmit("res 3,(ix+6),c", 0xdd, 0xcb, 0x06, 0x99);
    testCodeEmit("res 3,(ix-#0c),c", 0xdd, 0xcb, 0xf4, 0x99);
    testCodeEmit("res 3,(ix),d", 0xdd, 0xcb, 0x00, 0x9a);
    testCodeEmit("res 3,(ix+6),d", 0xdd, 0xcb, 0x06, 0x9a);
    testCodeEmit("res 3,(ix-#0c),d", 0xdd, 0xcb, 0xf4, 0x9a);
    testCodeEmit("res 3,(ix),e", 0xdd, 0xcb, 0x00, 0x9b);
    testCodeEmit("res 3,(ix+6),e", 0xdd, 0xcb, 0x06, 0x9b);
    testCodeEmit("res 3,(ix-#0c),e", 0xdd, 0xcb, 0xf4, 0x9b);
    testCodeEmit("res 3,(ix),h", 0xdd, 0xcb, 0x00, 0x9c);
    testCodeEmit("res 3,(ix+6),h", 0xdd, 0xcb, 0x06, 0x9c);
    testCodeEmit("res 3,(ix-#0c),h", 0xdd, 0xcb, 0xf4, 0x9c);
    testCodeEmit("res 3,(ix),l", 0xdd, 0xcb, 0x00, 0x9d);
    testCodeEmit("res 3,(ix+6),l", 0xdd, 0xcb, 0x06, 0x9d);
    testCodeEmit("res 3,(ix-#0c),l", 0xdd, 0xcb, 0xf4, 0x9d);
    testCodeEmit("res 3,(ix)", 0xdd, 0xcb, 0x00, 0x9e);
    testCodeEmit("res 3,(ix+6)", 0xdd, 0xcb, 0x06, 0x9e);
    testCodeEmit("res 3,(ix-#0c)", 0xdd, 0xcb, 0xf4, 0x9e);
    testCodeEmit("res 3,(ix),a", 0xdd, 0xcb, 0x00, 0x9f);
    testCodeEmit("res 3,(ix+6),a", 0xdd, 0xcb, 0x06, 0x9f);
    testCodeEmit("res 3,(ix-#0c),a", 0xdd, 0xcb, 0xf4, 0x9f);

    testCodeEmit("res 4,(ix),b", 0xdd, 0xcb, 0x00, 0xa0);
    testCodeEmit("res 4,(ix+6),b", 0xdd, 0xcb, 0x06, 0xa0);
    testCodeEmit("res 4,(ix-#0c),b", 0xdd, 0xcb, 0xf4, 0xa0);
    testCodeEmit("res 4,(ix),c", 0xdd, 0xcb, 0x00, 0xa1);
    testCodeEmit("res 4,(ix+6),c", 0xdd, 0xcb, 0x06, 0xa1);
    testCodeEmit("res 4,(ix-#0c),c", 0xdd, 0xcb, 0xf4, 0xa1);
    testCodeEmit("res 4,(ix),d", 0xdd, 0xcb, 0x00, 0xa2);
    testCodeEmit("res 4,(ix+6),d", 0xdd, 0xcb, 0x06, 0xa2);
    testCodeEmit("res 4,(ix-#0c),d", 0xdd, 0xcb, 0xf4, 0xa2);
    testCodeEmit("res 4,(ix),e", 0xdd, 0xcb, 0x00, 0xa3);
    testCodeEmit("res 4,(ix+6),e", 0xdd, 0xcb, 0x06, 0xa3);
    testCodeEmit("res 4,(ix-#0c),e", 0xdd, 0xcb, 0xf4, 0xa3);
    testCodeEmit("res 4,(ix),h", 0xdd, 0xcb, 0x00, 0xa4);
    testCodeEmit("res 4,(ix+6),h", 0xdd, 0xcb, 0x06, 0xa4);
    testCodeEmit("res 4,(ix-#0c),h", 0xdd, 0xcb, 0xf4, 0xa4);
    testCodeEmit("res 4,(ix),l", 0xdd, 0xcb, 0x00, 0xa5);
    testCodeEmit("res 4,(ix+6),l", 0xdd, 0xcb, 0x06, 0xa5);
    testCodeEmit("res 4,(ix-#0c),l", 0xdd, 0xcb, 0xf4, 0xa5);
    testCodeEmit("res 4,(ix)", 0xdd, 0xcb, 0x00, 0xa6);
    testCodeEmit("res 4,(ix+6)", 0xdd, 0xcb, 0x06, 0xa6);
    testCodeEmit("res 4,(ix-#0c)", 0xdd, 0xcb, 0xf4, 0xa6);
    testCodeEmit("res 4,(ix),a", 0xdd, 0xcb, 0x00, 0xa7);
    testCodeEmit("res 4,(ix+6),a", 0xdd, 0xcb, 0x06, 0xa7);
    testCodeEmit("res 4,(ix-#0c),a", 0xdd, 0xcb, 0xf4, 0xa7);

    testCodeEmit("res 5,(ix),b", 0xdd, 0xcb, 0x00, 0xa8);
    testCodeEmit("res 5,(ix+6),b", 0xdd, 0xcb, 0x06, 0xa8);
    testCodeEmit("res 5,(ix-#0c),b", 0xdd, 0xcb, 0xf4, 0xa8);
    testCodeEmit("res 5,(ix),c", 0xdd, 0xcb, 0x00, 0xa9);
    testCodeEmit("res 5,(ix+6),c", 0xdd, 0xcb, 0x06, 0xa9);
    testCodeEmit("res 5,(ix-#0c),c", 0xdd, 0xcb, 0xf4, 0xa9);
    testCodeEmit("res 5,(ix),d", 0xdd, 0xcb, 0x00, 0xaa);
    testCodeEmit("res 5,(ix+6),d", 0xdd, 0xcb, 0x06, 0xaa);
    testCodeEmit("res 5,(ix-#0c),d", 0xdd, 0xcb, 0xf4, 0xaa);
    testCodeEmit("res 5,(ix),e", 0xdd, 0xcb, 0x00, 0xab);
    testCodeEmit("res 5,(ix+6),e", 0xdd, 0xcb, 0x06, 0xab);
    testCodeEmit("res 5,(ix-#0c),e", 0xdd, 0xcb, 0xf4, 0xab);
    testCodeEmit("res 5,(ix),h", 0xdd, 0xcb, 0x00, 0xac);
    testCodeEmit("res 5,(ix+6),h", 0xdd, 0xcb, 0x06, 0xac);
    testCodeEmit("res 5,(ix-#0c),h", 0xdd, 0xcb, 0xf4, 0xac);
    testCodeEmit("res 5,(ix),l", 0xdd, 0xcb, 0x00, 0xad);
    testCodeEmit("res 5,(ix+6),l", 0xdd, 0xcb, 0x06, 0xad);
    testCodeEmit("res 5,(ix-#0c),l", 0xdd, 0xcb, 0xf4, 0xad);
    testCodeEmit("res 5,(ix)", 0xdd, 0xcb, 0x00, 0xae);
    testCodeEmit("res 5,(ix+6)", 0xdd, 0xcb, 0x06, 0xae);
    testCodeEmit("res 5,(ix-#0c)", 0xdd, 0xcb, 0xf4, 0xae);
    testCodeEmit("res 5,(ix),a", 0xdd, 0xcb, 0x00, 0xaf);
    testCodeEmit("res 5,(ix+6),a", 0xdd, 0xcb, 0x06, 0xaf);
    testCodeEmit("res 5,(ix-#0c),a", 0xdd, 0xcb, 0xf4, 0xaf);

    testCodeEmit("res 6,(ix),b", 0xdd, 0xcb, 0x00, 0xb0);
    testCodeEmit("res 6,(ix+6),b", 0xdd, 0xcb, 0x06, 0xb0);
    testCodeEmit("res 6,(ix-#0c),b", 0xdd, 0xcb, 0xf4, 0xb0);
    testCodeEmit("res 6,(ix),c", 0xdd, 0xcb, 0x00, 0xb1);
    testCodeEmit("res 6,(ix+6),c", 0xdd, 0xcb, 0x06, 0xb1);
    testCodeEmit("res 6,(ix-#0c),c", 0xdd, 0xcb, 0xf4, 0xb1);
    testCodeEmit("res 6,(ix),d", 0xdd, 0xcb, 0x00, 0xb2);
    testCodeEmit("res 6,(ix+6),d", 0xdd, 0xcb, 0x06, 0xb2);
    testCodeEmit("res 6,(ix-#0c),d", 0xdd, 0xcb, 0xf4, 0xb2);
    testCodeEmit("res 6,(ix),e", 0xdd, 0xcb, 0x00, 0xb3);
    testCodeEmit("res 6,(ix+6),e", 0xdd, 0xcb, 0x06, 0xb3);
    testCodeEmit("res 6,(ix-#0c),e", 0xdd, 0xcb, 0xf4, 0xb3);
    testCodeEmit("res 6,(ix),h", 0xdd, 0xcb, 0x00, 0xb4);
    testCodeEmit("res 6,(ix+6),h", 0xdd, 0xcb, 0x06, 0xb4);
    testCodeEmit("res 6,(ix-#0c),h", 0xdd, 0xcb, 0xf4, 0xb4);
    testCodeEmit("res 6,(ix),l", 0xdd, 0xcb, 0x00, 0xb5);
    testCodeEmit("res 6,(ix+6),l", 0xdd, 0xcb, 0x06, 0xb5);
    testCodeEmit("res 6,(ix-#0c),l", 0xdd, 0xcb, 0xf4, 0xb5);
    testCodeEmit("res 6,(ix)", 0xdd, 0xcb, 0x00, 0xb6);
    testCodeEmit("res 6,(ix+6)", 0xdd, 0xcb, 0x06, 0xb6);
    testCodeEmit("res 6,(ix-#0c)", 0xdd, 0xcb, 0xf4, 0xb6);
    testCodeEmit("res 6,(ix),a", 0xdd, 0xcb, 0x00, 0xb7);
    testCodeEmit("res 6,(ix+6),a", 0xdd, 0xcb, 0x06, 0xb7);
    testCodeEmit("res 6,(ix-#0c),a", 0xdd, 0xcb, 0xf4, 0xb7);

    testCodeEmit("res 7,(ix),b", 0xdd, 0xcb, 0x00, 0xb8);
    testCodeEmit("res 7,(ix+6),b", 0xdd, 0xcb, 0x06, 0xb8);
    testCodeEmit("res 7,(ix-#0c),b", 0xdd, 0xcb, 0xf4, 0xb8);
    testCodeEmit("res 7,(ix),c", 0xdd, 0xcb, 0x00, 0xb9);
    testCodeEmit("res 7,(ix+6),c", 0xdd, 0xcb, 0x06, 0xb9);
    testCodeEmit("res 7,(ix-#0c),c", 0xdd, 0xcb, 0xf4, 0xb9);
    testCodeEmit("res 7,(ix),d", 0xdd, 0xcb, 0x00, 0xba);
    testCodeEmit("res 7,(ix+6),d", 0xdd, 0xcb, 0x06, 0xba);
    testCodeEmit("res 7,(ix-#0c),d", 0xdd, 0xcb, 0xf4, 0xba);
    testCodeEmit("res 7,(ix),e", 0xdd, 0xcb, 0x00, 0xbb);
    testCodeEmit("res 7,(ix+6),e", 0xdd, 0xcb, 0x06, 0xbb);
    testCodeEmit("res 7,(ix-#0c),e", 0xdd, 0xcb, 0xf4, 0xbb);
    testCodeEmit("res 7,(ix),h", 0xdd, 0xcb, 0x00, 0xbc);
    testCodeEmit("res 7,(ix+6),h", 0xdd, 0xcb, 0x06, 0xbc);
    testCodeEmit("res 7,(ix-#0c),h", 0xdd, 0xcb, 0xf4, 0xbc);
    testCodeEmit("res 7,(ix),l", 0xdd, 0xcb, 0x00, 0xbd);
    testCodeEmit("res 7,(ix+6),l", 0xdd, 0xcb, 0x06, 0xbd);
    testCodeEmit("res 7,(ix-#0c),l", 0xdd, 0xcb, 0xf4, 0xbd);
    testCodeEmit("res 7,(ix)", 0xdd, 0xcb, 0x00, 0xbe);
    testCodeEmit("res 7,(ix+6)", 0xdd, 0xcb, 0x06, 0xbe);
    testCodeEmit("res 7,(ix-#0c)", 0xdd, 0xcb, 0xf4, 0xbe);
    testCodeEmit("res 7,(ix),a", 0xdd, 0xcb, 0x00, 0xbf);
    testCodeEmit("res 7,(ix+6),a", 0xdd, 0xcb, 0x06, 0xbf);
    testCodeEmit("res 7,(ix-#0c),a", 0xdd, 0xcb, 0xf4, 0xbf);

    testCodeEmit("res 0,(iy),b", 0xfd, 0xcb, 0x00, 0x80);
    testCodeEmit("res 0,(iy+6),b", 0xfd, 0xcb, 0x06, 0x80);
    testCodeEmit("res 0,(iy-#0c),b", 0xfd, 0xcb, 0xf4, 0x80);
    testCodeEmit("res 0,(iy),c", 0xfd, 0xcb, 0x00, 0x81);
    testCodeEmit("res 0,(iy+6),c", 0xfd, 0xcb, 0x06, 0x81);
    testCodeEmit("res 0,(iy-#0c),c", 0xfd, 0xcb, 0xf4, 0x81);
    testCodeEmit("res 0,(iy),d", 0xfd, 0xcb, 0x00, 0x82);
    testCodeEmit("res 0,(iy+6),d", 0xfd, 0xcb, 0x06, 0x82);
    testCodeEmit("res 0,(iy-#0c),d", 0xfd, 0xcb, 0xf4, 0x82);
    testCodeEmit("res 0,(iy),e", 0xfd, 0xcb, 0x00, 0x83);
    testCodeEmit("res 0,(iy+6),e", 0xfd, 0xcb, 0x06, 0x83);
    testCodeEmit("res 0,(iy-#0c),e", 0xfd, 0xcb, 0xf4, 0x83);
    testCodeEmit("res 0,(iy),h", 0xfd, 0xcb, 0x00, 0x84);
    testCodeEmit("res 0,(iy+6),h", 0xfd, 0xcb, 0x06, 0x84);
    testCodeEmit("res 0,(iy-#0c),h", 0xfd, 0xcb, 0xf4, 0x84);
    testCodeEmit("res 0,(iy),l", 0xfd, 0xcb, 0x00, 0x85);
    testCodeEmit("res 0,(iy+6),l", 0xfd, 0xcb, 0x06, 0x85);
    testCodeEmit("res 0,(iy-#0c),l", 0xfd, 0xcb, 0xf4, 0x85);
    testCodeEmit("res 0,(iy)", 0xfd, 0xcb, 0x00, 0x86);
    testCodeEmit("res 0,(iy+6)", 0xfd, 0xcb, 0x06, 0x86);
    testCodeEmit("res 0,(iy-#0c)", 0xfd, 0xcb, 0xf4, 0x86);
    testCodeEmit("res 0,(iy),a", 0xfd, 0xcb, 0x00, 0x87);
    testCodeEmit("res 0,(iy+6),a", 0xfd, 0xcb, 0x06, 0x87);
    testCodeEmit("res 0,(iy-#0c),a", 0xfd, 0xcb, 0xf4, 0x87);

    testCodeEmit("res 1,(iy),b", 0xfd, 0xcb, 0x00, 0x88);
    testCodeEmit("res 1,(iy+6),b", 0xfd, 0xcb, 0x06, 0x88);
    testCodeEmit("res 1,(iy-#0c),b", 0xfd, 0xcb, 0xf4, 0x88);
    testCodeEmit("res 1,(iy),c", 0xfd, 0xcb, 0x00, 0x89);
    testCodeEmit("res 1,(iy+6),c", 0xfd, 0xcb, 0x06, 0x89);
    testCodeEmit("res 1,(iy-#0c),c", 0xfd, 0xcb, 0xf4, 0x89);
    testCodeEmit("res 1,(iy),d", 0xfd, 0xcb, 0x00, 0x8a);
    testCodeEmit("res 1,(iy+6),d", 0xfd, 0xcb, 0x06, 0x8a);
    testCodeEmit("res 1,(iy-#0c),d", 0xfd, 0xcb, 0xf4, 0x8a);
    testCodeEmit("res 1,(iy),e", 0xfd, 0xcb, 0x00, 0x8b);
    testCodeEmit("res 1,(iy+6),e", 0xfd, 0xcb, 0x06, 0x8b);
    testCodeEmit("res 1,(iy-#0c),e", 0xfd, 0xcb, 0xf4, 0x8b);
    testCodeEmit("res 1,(iy),h", 0xfd, 0xcb, 0x00, 0x8c);
    testCodeEmit("res 1,(iy+6),h", 0xfd, 0xcb, 0x06, 0x8c);
    testCodeEmit("res 1,(iy-#0c),h", 0xfd, 0xcb, 0xf4, 0x8c);
    testCodeEmit("res 1,(iy),l", 0xfd, 0xcb, 0x00, 0x8d);
    testCodeEmit("res 1,(iy+6),l", 0xfd, 0xcb, 0x06, 0x8d);
    testCodeEmit("res 1,(iy-#0c),l", 0xfd, 0xcb, 0xf4, 0x8d);
    testCodeEmit("res 1,(iy)", 0xfd, 0xcb, 0x00, 0x8e);
    testCodeEmit("res 1,(iy+6)", 0xfd, 0xcb, 0x06, 0x8e);
    testCodeEmit("res 1,(iy-#0c)", 0xfd, 0xcb, 0xf4, 0x8e);
    testCodeEmit("res 1,(iy),a", 0xfd, 0xcb, 0x00, 0x8f);
    testCodeEmit("res 1,(iy+6),a", 0xfd, 0xcb, 0x06, 0x8f);
    testCodeEmit("res 1,(iy-#0c),a", 0xfd, 0xcb, 0xf4, 0x8f);

    testCodeEmit("res 2,(iy),b", 0xfd, 0xcb, 0x00, 0x90);
    testCodeEmit("res 2,(iy+6),b", 0xfd, 0xcb, 0x06, 0x90);
    testCodeEmit("res 2,(iy-#0c),b", 0xfd, 0xcb, 0xf4, 0x90);
    testCodeEmit("res 2,(iy),c", 0xfd, 0xcb, 0x00, 0x91);
    testCodeEmit("res 2,(iy+6),c", 0xfd, 0xcb, 0x06, 0x91);
    testCodeEmit("res 2,(iy-#0c),c", 0xfd, 0xcb, 0xf4, 0x91);
    testCodeEmit("res 2,(iy),d", 0xfd, 0xcb, 0x00, 0x92);
    testCodeEmit("res 2,(iy+6),d", 0xfd, 0xcb, 0x06, 0x92);
    testCodeEmit("res 2,(iy-#0c),d", 0xfd, 0xcb, 0xf4, 0x92);
    testCodeEmit("res 2,(iy),e", 0xfd, 0xcb, 0x00, 0x93);
    testCodeEmit("res 2,(iy+6),e", 0xfd, 0xcb, 0x06, 0x93);
    testCodeEmit("res 2,(iy-#0c),e", 0xfd, 0xcb, 0xf4, 0x93);
    testCodeEmit("res 2,(iy),h", 0xfd, 0xcb, 0x00, 0x94);
    testCodeEmit("res 2,(iy+6),h", 0xfd, 0xcb, 0x06, 0x94);
    testCodeEmit("res 2,(iy-#0c),h", 0xfd, 0xcb, 0xf4, 0x94);
    testCodeEmit("res 2,(iy),l", 0xfd, 0xcb, 0x00, 0x95);
    testCodeEmit("res 2,(iy+6),l", 0xfd, 0xcb, 0x06, 0x95);
    testCodeEmit("res 2,(iy-#0c),l", 0xfd, 0xcb, 0xf4, 0x95);
    testCodeEmit("res 2,(iy)", 0xfd, 0xcb, 0x00, 0x96);
    testCodeEmit("res 2,(iy+6)", 0xfd, 0xcb, 0x06, 0x96);
    testCodeEmit("res 2,(iy-#0c)", 0xfd, 0xcb, 0xf4, 0x96);
    testCodeEmit("res 2,(iy),a", 0xfd, 0xcb, 0x00, 0x97);
    testCodeEmit("res 2,(iy+6),a", 0xfd, 0xcb, 0x06, 0x97);
    testCodeEmit("res 2,(iy-#0c),a", 0xfd, 0xcb, 0xf4, 0x97);

    testCodeEmit("res 3,(iy),b", 0xfd, 0xcb, 0x00, 0x98);
    testCodeEmit("res 3,(iy+6),b", 0xfd, 0xcb, 0x06, 0x98);
    testCodeEmit("res 3,(iy-#0c),b", 0xfd, 0xcb, 0xf4, 0x98);
    testCodeEmit("res 3,(iy),c", 0xfd, 0xcb, 0x00, 0x99);
    testCodeEmit("res 3,(iy+6),c", 0xfd, 0xcb, 0x06, 0x99);
    testCodeEmit("res 3,(iy-#0c),c", 0xfd, 0xcb, 0xf4, 0x99);
    testCodeEmit("res 3,(iy),d", 0xfd, 0xcb, 0x00, 0x9a);
    testCodeEmit("res 3,(iy+6),d", 0xfd, 0xcb, 0x06, 0x9a);
    testCodeEmit("res 3,(iy-#0c),d", 0xfd, 0xcb, 0xf4, 0x9a);
    testCodeEmit("res 3,(iy),e", 0xfd, 0xcb, 0x00, 0x9b);
    testCodeEmit("res 3,(iy+6),e", 0xfd, 0xcb, 0x06, 0x9b);
    testCodeEmit("res 3,(iy-#0c),e", 0xfd, 0xcb, 0xf4, 0x9b);
    testCodeEmit("res 3,(iy),h", 0xfd, 0xcb, 0x00, 0x9c);
    testCodeEmit("res 3,(iy+6),h", 0xfd, 0xcb, 0x06, 0x9c);
    testCodeEmit("res 3,(iy-#0c),h", 0xfd, 0xcb, 0xf4, 0x9c);
    testCodeEmit("res 3,(iy),l", 0xfd, 0xcb, 0x00, 0x9d);
    testCodeEmit("res 3,(iy+6),l", 0xfd, 0xcb, 0x06, 0x9d);
    testCodeEmit("res 3,(iy-#0c),l", 0xfd, 0xcb, 0xf4, 0x9d);
    testCodeEmit("res 3,(iy)", 0xfd, 0xcb, 0x00, 0x9e);
    testCodeEmit("res 3,(iy+6)", 0xfd, 0xcb, 0x06, 0x9e);
    testCodeEmit("res 3,(iy-#0c)", 0xfd, 0xcb, 0xf4, 0x9e);
    testCodeEmit("res 3,(iy),a", 0xfd, 0xcb, 0x00, 0x9f);
    testCodeEmit("res 3,(iy+6),a", 0xfd, 0xcb, 0x06, 0x9f);
    testCodeEmit("res 3,(iy-#0c),a", 0xfd, 0xcb, 0xf4, 0x9f);

    testCodeEmit("res 4,(iy),b", 0xfd, 0xcb, 0x00, 0xa0);
    testCodeEmit("res 4,(iy+6),b", 0xfd, 0xcb, 0x06, 0xa0);
    testCodeEmit("res 4,(iy-#0c),b", 0xfd, 0xcb, 0xf4, 0xa0);
    testCodeEmit("res 4,(iy),c", 0xfd, 0xcb, 0x00, 0xa1);
    testCodeEmit("res 4,(iy+6),c", 0xfd, 0xcb, 0x06, 0xa1);
    testCodeEmit("res 4,(iy-#0c),c", 0xfd, 0xcb, 0xf4, 0xa1);
    testCodeEmit("res 4,(iy),d", 0xfd, 0xcb, 0x00, 0xa2);
    testCodeEmit("res 4,(iy+6),d", 0xfd, 0xcb, 0x06, 0xa2);
    testCodeEmit("res 4,(iy-#0c),d", 0xfd, 0xcb, 0xf4, 0xa2);
    testCodeEmit("res 4,(iy),e", 0xfd, 0xcb, 0x00, 0xa3);
    testCodeEmit("res 4,(iy+6),e", 0xfd, 0xcb, 0x06, 0xa3);
    testCodeEmit("res 4,(iy-#0c),e", 0xfd, 0xcb, 0xf4, 0xa3);
    testCodeEmit("res 4,(iy),h", 0xfd, 0xcb, 0x00, 0xa4);
    testCodeEmit("res 4,(iy+6),h", 0xfd, 0xcb, 0x06, 0xa4);
    testCodeEmit("res 4,(iy-#0c),h", 0xfd, 0xcb, 0xf4, 0xa4);
    testCodeEmit("res 4,(iy),l", 0xfd, 0xcb, 0x00, 0xa5);
    testCodeEmit("res 4,(iy+6),l", 0xfd, 0xcb, 0x06, 0xa5);
    testCodeEmit("res 4,(iy-#0c),l", 0xfd, 0xcb, 0xf4, 0xa5);
    testCodeEmit("res 4,(iy)", 0xfd, 0xcb, 0x00, 0xa6);
    testCodeEmit("res 4,(iy+6)", 0xfd, 0xcb, 0x06, 0xa6);
    testCodeEmit("res 4,(iy-#0c)", 0xfd, 0xcb, 0xf4, 0xa6);
    testCodeEmit("res 4,(iy),a", 0xfd, 0xcb, 0x00, 0xa7);
    testCodeEmit("res 4,(iy+6),a", 0xfd, 0xcb, 0x06, 0xa7);
    testCodeEmit("res 4,(iy-#0c),a", 0xfd, 0xcb, 0xf4, 0xa7);

    testCodeEmit("res 5,(iy),b", 0xfd, 0xcb, 0x00, 0xa8);
    testCodeEmit("res 5,(iy+6),b", 0xfd, 0xcb, 0x06, 0xa8);
    testCodeEmit("res 5,(iy-#0c),b", 0xfd, 0xcb, 0xf4, 0xa8);
    testCodeEmit("res 5,(iy),c", 0xfd, 0xcb, 0x00, 0xa9);
    testCodeEmit("res 5,(iy+6),c", 0xfd, 0xcb, 0x06, 0xa9);
    testCodeEmit("res 5,(iy-#0c),c", 0xfd, 0xcb, 0xf4, 0xa9);
    testCodeEmit("res 5,(iy),d", 0xfd, 0xcb, 0x00, 0xaa);
    testCodeEmit("res 5,(iy+6),d", 0xfd, 0xcb, 0x06, 0xaa);
    testCodeEmit("res 5,(iy-#0c),d", 0xfd, 0xcb, 0xf4, 0xaa);
    testCodeEmit("res 5,(iy),e", 0xfd, 0xcb, 0x00, 0xab);
    testCodeEmit("res 5,(iy+6),e", 0xfd, 0xcb, 0x06, 0xab);
    testCodeEmit("res 5,(iy-#0c),e", 0xfd, 0xcb, 0xf4, 0xab);
    testCodeEmit("res 5,(iy),h", 0xfd, 0xcb, 0x00, 0xac);
    testCodeEmit("res 5,(iy+6),h", 0xfd, 0xcb, 0x06, 0xac);
    testCodeEmit("res 5,(iy-#0c),h", 0xfd, 0xcb, 0xf4, 0xac);
    testCodeEmit("res 5,(iy),l", 0xfd, 0xcb, 0x00, 0xad);
    testCodeEmit("res 5,(iy+6),l", 0xfd, 0xcb, 0x06, 0xad);
    testCodeEmit("res 5,(iy-#0c),l", 0xfd, 0xcb, 0xf4, 0xad);
    testCodeEmit("res 5,(iy)", 0xfd, 0xcb, 0x00, 0xae);
    testCodeEmit("res 5,(iy+6)", 0xfd, 0xcb, 0x06, 0xae);
    testCodeEmit("res 5,(iy-#0c)", 0xfd, 0xcb, 0xf4, 0xae);
    testCodeEmit("res 5,(iy),a", 0xfd, 0xcb, 0x00, 0xaf);
    testCodeEmit("res 5,(iy+6),a", 0xfd, 0xcb, 0x06, 0xaf);
    testCodeEmit("res 5,(iy-#0c),a", 0xfd, 0xcb, 0xf4, 0xaf);

    testCodeEmit("res 6,(iy),b", 0xfd, 0xcb, 0x00, 0xb0);
    testCodeEmit("res 6,(iy+6),b", 0xfd, 0xcb, 0x06, 0xb0);
    testCodeEmit("res 6,(iy-#0c),b", 0xfd, 0xcb, 0xf4, 0xb0);
    testCodeEmit("res 6,(iy),c", 0xfd, 0xcb, 0x00, 0xb1);
    testCodeEmit("res 6,(iy+6),c", 0xfd, 0xcb, 0x06, 0xb1);
    testCodeEmit("res 6,(iy-#0c),c", 0xfd, 0xcb, 0xf4, 0xb1);
    testCodeEmit("res 6,(iy),d", 0xfd, 0xcb, 0x00, 0xb2);
    testCodeEmit("res 6,(iy+6),d", 0xfd, 0xcb, 0x06, 0xb2);
    testCodeEmit("res 6,(iy-#0c),d", 0xfd, 0xcb, 0xf4, 0xb2);
    testCodeEmit("res 6,(iy),e", 0xfd, 0xcb, 0x00, 0xb3);
    testCodeEmit("res 6,(iy+6),e", 0xfd, 0xcb, 0x06, 0xb3);
    testCodeEmit("res 6,(iy-#0c),e", 0xfd, 0xcb, 0xf4, 0xb3);
    testCodeEmit("res 6,(iy),h", 0xfd, 0xcb, 0x00, 0xb4);
    testCodeEmit("res 6,(iy+6),h", 0xfd, 0xcb, 0x06, 0xb4);
    testCodeEmit("res 6,(iy-#0c),h", 0xfd, 0xcb, 0xf4, 0xb4);
    testCodeEmit("res 6,(iy),l", 0xfd, 0xcb, 0x00, 0xb5);
    testCodeEmit("res 6,(iy+6),l", 0xfd, 0xcb, 0x06, 0xb5);
    testCodeEmit("res 6,(iy-#0c),l", 0xfd, 0xcb, 0xf4, 0xb5);
    testCodeEmit("res 6,(iy)", 0xfd, 0xcb, 0x00, 0xb6);
    testCodeEmit("res 6,(iy+6)", 0xfd, 0xcb, 0x06, 0xb6);
    testCodeEmit("res 6,(iy-#0c)", 0xfd, 0xcb, 0xf4, 0xb6);
    testCodeEmit("res 6,(iy),a", 0xfd, 0xcb, 0x00, 0xb7);
    testCodeEmit("res 6,(iy+6),a", 0xfd, 0xcb, 0x06, 0xb7);
    testCodeEmit("res 6,(iy-#0c),a", 0xfd, 0xcb, 0xf4, 0xb7);

    testCodeEmit("res 7,(iy),b", 0xfd, 0xcb, 0x00, 0xb8);
    testCodeEmit("res 7,(iy+6),b", 0xfd, 0xcb, 0x06, 0xb8);
    testCodeEmit("res 7,(iy-#0c),b", 0xfd, 0xcb, 0xf4, 0xb8);
    testCodeEmit("res 7,(iy),c", 0xfd, 0xcb, 0x00, 0xb9);
    testCodeEmit("res 7,(iy+6),c", 0xfd, 0xcb, 0x06, 0xb9);
    testCodeEmit("res 7,(iy-#0c),c", 0xfd, 0xcb, 0xf4, 0xb9);
    testCodeEmit("res 7,(iy),d", 0xfd, 0xcb, 0x00, 0xba);
    testCodeEmit("res 7,(iy+6),d", 0xfd, 0xcb, 0x06, 0xba);
    testCodeEmit("res 7,(iy-#0c),d", 0xfd, 0xcb, 0xf4, 0xba);
    testCodeEmit("res 7,(iy),e", 0xfd, 0xcb, 0x00, 0xbb);
    testCodeEmit("res 7,(iy+6),e", 0xfd, 0xcb, 0x06, 0xbb);
    testCodeEmit("res 7,(iy-#0c),e", 0xfd, 0xcb, 0xf4, 0xbb);
    testCodeEmit("res 7,(iy),h", 0xfd, 0xcb, 0x00, 0xbc);
    testCodeEmit("res 7,(iy+6),h", 0xfd, 0xcb, 0x06, 0xbc);
    testCodeEmit("res 7,(iy-#0c),h", 0xfd, 0xcb, 0xf4, 0xbc);
    testCodeEmit("res 7,(iy),l", 0xfd, 0xcb, 0x00, 0xbd);
    testCodeEmit("res 7,(iy+6),l", 0xfd, 0xcb, 0x06, 0xbd);
    testCodeEmit("res 7,(iy-#0c),l", 0xfd, 0xcb, 0xf4, 0xbd);
    testCodeEmit("res 7,(iy)", 0xfd, 0xcb, 0x00, 0xbe);
    testCodeEmit("res 7,(iy+6)", 0xfd, 0xcb, 0x06, 0xbe);
    testCodeEmit("res 7,(iy-#0c)", 0xfd, 0xcb, 0xf4, 0xbe);
    testCodeEmit("res 7,(iy),a", 0xfd, 0xcb, 0x00, 0xbf);
    testCodeEmit("res 7,(iy+6),a", 0xfd, 0xcb, 0x06, 0xbf);
    testCodeEmit("res 7,(iy-#0c),a", 0xfd, 0xcb, 0xf4, 0xbf);
  });

  it("set", () => {
    testCodeEmit("set 0,b", 0xcb, 0xc0);
    testCodeEmit("set 0,c", 0xcb, 0xc1);
    testCodeEmit("set 0,d", 0xcb, 0xc2);
    testCodeEmit("set 0,e", 0xcb, 0xc3);
    testCodeEmit("set 0,h", 0xcb, 0xc4);
    testCodeEmit("set 0,l", 0xcb, 0xc5);
    testCodeEmit("set 0,(hl)", 0xcb, 0xc6);
    testCodeEmit("set 0,a", 0xcb, 0xc7);

    testCodeEmit("set 1,b", 0xcb, 0xc8);
    testCodeEmit("set 1,c", 0xcb, 0xc9);
    testCodeEmit("set 1,d", 0xcb, 0xca);
    testCodeEmit("set 1,e", 0xcb, 0xcb);
    testCodeEmit("set 1,h", 0xcb, 0xcc);
    testCodeEmit("set 1,l", 0xcb, 0xcd);
    testCodeEmit("set 1,(hl)", 0xcb, 0xce);
    testCodeEmit("set 1,a", 0xcb, 0xcf);

    testCodeEmit("set 2,b", 0xcb, 0xd0);
    testCodeEmit("set 2,c", 0xcb, 0xd1);
    testCodeEmit("set 2,d", 0xcb, 0xd2);
    testCodeEmit("set 2,e", 0xcb, 0xd3);
    testCodeEmit("set 2,h", 0xcb, 0xd4);
    testCodeEmit("set 2,l", 0xcb, 0xd5);
    testCodeEmit("set 2,(hl)", 0xcb, 0xd6);
    testCodeEmit("set 2,a", 0xcb, 0xd7);

    testCodeEmit("set 3,b", 0xcb, 0xd8);
    testCodeEmit("set 3,c", 0xcb, 0xd9);
    testCodeEmit("set 3,d", 0xcb, 0xda);
    testCodeEmit("set 3,e", 0xcb, 0xdb);
    testCodeEmit("set 3,h", 0xcb, 0xdc);
    testCodeEmit("set 3,l", 0xcb, 0xdd);
    testCodeEmit("set 3,(hl)", 0xcb, 0xde);
    testCodeEmit("set 3,a", 0xcb, 0xdf);

    testCodeEmit("set 4,b", 0xcb, 0xe0);
    testCodeEmit("set 4,c", 0xcb, 0xe1);
    testCodeEmit("set 4,d", 0xcb, 0xe2);
    testCodeEmit("set 4,e", 0xcb, 0xe3);
    testCodeEmit("set 4,h", 0xcb, 0xe4);
    testCodeEmit("set 4,l", 0xcb, 0xe5);
    testCodeEmit("set 4,(hl)", 0xcb, 0xe6);
    testCodeEmit("set 4,a", 0xcb, 0xe7);

    testCodeEmit("set 5,b", 0xcb, 0xe8);
    testCodeEmit("set 5,c", 0xcb, 0xe9);
    testCodeEmit("set 5,d", 0xcb, 0xea);
    testCodeEmit("set 5,e", 0xcb, 0xeb);
    testCodeEmit("set 5,h", 0xcb, 0xec);
    testCodeEmit("set 5,l", 0xcb, 0xed);
    testCodeEmit("set 5,(hl)", 0xcb, 0xee);
    testCodeEmit("set 5,a", 0xcb, 0xef);

    testCodeEmit("set 6,b", 0xcb, 0xf0);
    testCodeEmit("set 6,c", 0xcb, 0xf1);
    testCodeEmit("set 6,d", 0xcb, 0xf2);
    testCodeEmit("set 6,e", 0xcb, 0xf3);
    testCodeEmit("set 6,h", 0xcb, 0xf4);
    testCodeEmit("set 6,l", 0xcb, 0xf5);
    testCodeEmit("set 6,(hl)", 0xcb, 0xf6);
    testCodeEmit("set 6,a", 0xcb, 0xf7);

    testCodeEmit("set 7,b", 0xcb, 0xf8);
    testCodeEmit("set 7,c", 0xcb, 0xf9);
    testCodeEmit("set 7,d", 0xcb, 0xfa);
    testCodeEmit("set 7,e", 0xcb, 0xfb);
    testCodeEmit("set 7,h", 0xcb, 0xfc);
    testCodeEmit("set 7,l", 0xcb, 0xfd);
    testCodeEmit("set 7,(hl)", 0xcb, 0xfe);
    testCodeEmit("set 7,a", 0xcb, 0xff);
  });

  it("set: fails with invalid operand", () => {
    codeRaisesError("set -1,b", "Z2049");
    codeRaisesError("set 8,b", "Z2049");
  });

  it("set: indexed instructions", () => {
    testCodeEmit("set 0,(ix),b", 0xdd, 0xcb, 0x00, 0xc0);
    testCodeEmit("set 0,(ix+6),b", 0xdd, 0xcb, 0x06, 0xc0);
    testCodeEmit("set 0,(ix-#0c),b", 0xdd, 0xcb, 0xf4, 0xc0);
    testCodeEmit("set 0,(ix),c", 0xdd, 0xcb, 0x00, 0xc1);
    testCodeEmit("set 0,(ix+6),c", 0xdd, 0xcb, 0x06, 0xc1);
    testCodeEmit("set 0,(ix-#0c),c", 0xdd, 0xcb, 0xf4, 0xc1);
    testCodeEmit("set 0,(ix),d", 0xdd, 0xcb, 0x00, 0xc2);
    testCodeEmit("set 0,(ix+6),d", 0xdd, 0xcb, 0x06, 0xc2);
    testCodeEmit("set 0,(ix-#0c),d", 0xdd, 0xcb, 0xf4, 0xc2);
    testCodeEmit("set 0,(ix),e", 0xdd, 0xcb, 0x00, 0xc3);
    testCodeEmit("set 0,(ix+6),e", 0xdd, 0xcb, 0x06, 0xc3);
    testCodeEmit("set 0,(ix-#0c),e", 0xdd, 0xcb, 0xf4, 0xc3);
    testCodeEmit("set 0,(ix),h", 0xdd, 0xcb, 0x00, 0xc4);
    testCodeEmit("set 0,(ix+6),h", 0xdd, 0xcb, 0x06, 0xc4);
    testCodeEmit("set 0,(ix-#0c),h", 0xdd, 0xcb, 0xf4, 0xc4);
    testCodeEmit("set 0,(ix),l", 0xdd, 0xcb, 0x00, 0xc5);
    testCodeEmit("set 0,(ix+6),l", 0xdd, 0xcb, 0x06, 0xc5);
    testCodeEmit("set 0,(ix-#0c),l", 0xdd, 0xcb, 0xf4, 0xc5);
    testCodeEmit("set 0,(ix)", 0xdd, 0xcb, 0x00, 0xc6);
    testCodeEmit("set 0,(ix+6)", 0xdd, 0xcb, 0x06, 0xc6);
    testCodeEmit("set 0,(ix-#0c)", 0xdd, 0xcb, 0xf4, 0xc6);
    testCodeEmit("set 0,(ix),a", 0xdd, 0xcb, 0x00, 0xc7);
    testCodeEmit("set 0,(ix+6),a", 0xdd, 0xcb, 0x06, 0xc7);
    testCodeEmit("set 0,(ix-#0c),a", 0xdd, 0xcb, 0xf4, 0xc7);

    testCodeEmit("set 1,(ix),b", 0xdd, 0xcb, 0x00, 0xc8);
    testCodeEmit("set 1,(ix+6),b", 0xdd, 0xcb, 0x06, 0xc8);
    testCodeEmit("set 1,(ix-#0c),b", 0xdd, 0xcb, 0xf4, 0xc8);
    testCodeEmit("set 1,(ix),c", 0xdd, 0xcb, 0x00, 0xc9);
    testCodeEmit("set 1,(ix+6),c", 0xdd, 0xcb, 0x06, 0xc9);
    testCodeEmit("set 1,(ix-#0c),c", 0xdd, 0xcb, 0xf4, 0xc9);
    testCodeEmit("set 1,(ix),d", 0xdd, 0xcb, 0x00, 0xca);
    testCodeEmit("set 1,(ix+6),d", 0xdd, 0xcb, 0x06, 0xca);
    testCodeEmit("set 1,(ix-#0c),d", 0xdd, 0xcb, 0xf4, 0xca);
    testCodeEmit("set 1,(ix),e", 0xdd, 0xcb, 0x00, 0xcb);
    testCodeEmit("set 1,(ix+6),e", 0xdd, 0xcb, 0x06, 0xcb);
    testCodeEmit("set 1,(ix-#0c),e", 0xdd, 0xcb, 0xf4, 0xcb);
    testCodeEmit("set 1,(ix),h", 0xdd, 0xcb, 0x00, 0xcc);
    testCodeEmit("set 1,(ix+6),h", 0xdd, 0xcb, 0x06, 0xcc);
    testCodeEmit("set 1,(ix-#0c),h", 0xdd, 0xcb, 0xf4, 0xcc);
    testCodeEmit("set 1,(ix),l", 0xdd, 0xcb, 0x00, 0xcd);
    testCodeEmit("set 1,(ix+6),l", 0xdd, 0xcb, 0x06, 0xcd);
    testCodeEmit("set 1,(ix-#0c),l", 0xdd, 0xcb, 0xf4, 0xcd);
    testCodeEmit("set 1,(ix)", 0xdd, 0xcb, 0x00, 0xce);
    testCodeEmit("set 1,(ix+6)", 0xdd, 0xcb, 0x06, 0xce);
    testCodeEmit("set 1,(ix-#0c)", 0xdd, 0xcb, 0xf4, 0xce);
    testCodeEmit("set 1,(ix),a", 0xdd, 0xcb, 0x00, 0xcf);
    testCodeEmit("set 1,(ix+6),a", 0xdd, 0xcb, 0x06, 0xcf);
    testCodeEmit("set 1,(ix-#0c),a", 0xdd, 0xcb, 0xf4, 0xcf);

    testCodeEmit("set 2,(ix),b", 0xdd, 0xcb, 0x00, 0xd0);
    testCodeEmit("set 2,(ix+6),b", 0xdd, 0xcb, 0x06, 0xd0);
    testCodeEmit("set 2,(ix-#0c),b", 0xdd, 0xcb, 0xf4, 0xd0);
    testCodeEmit("set 2,(ix),c", 0xdd, 0xcb, 0x00, 0xd1);
    testCodeEmit("set 2,(ix+6),c", 0xdd, 0xcb, 0x06, 0xd1);
    testCodeEmit("set 2,(ix-#0c),c", 0xdd, 0xcb, 0xf4, 0xd1);
    testCodeEmit("set 2,(ix),d", 0xdd, 0xcb, 0x00, 0xd2);
    testCodeEmit("set 2,(ix+6),d", 0xdd, 0xcb, 0x06, 0xd2);
    testCodeEmit("set 2,(ix-#0c),d", 0xdd, 0xcb, 0xf4, 0xd2);
    testCodeEmit("set 2,(ix),e", 0xdd, 0xcb, 0x00, 0xd3);
    testCodeEmit("set 2,(ix+6),e", 0xdd, 0xcb, 0x06, 0xd3);
    testCodeEmit("set 2,(ix-#0c),e", 0xdd, 0xcb, 0xf4, 0xd3);
    testCodeEmit("set 2,(ix),h", 0xdd, 0xcb, 0x00, 0xd4);
    testCodeEmit("set 2,(ix+6),h", 0xdd, 0xcb, 0x06, 0xd4);
    testCodeEmit("set 2,(ix-#0c),h", 0xdd, 0xcb, 0xf4, 0xd4);
    testCodeEmit("set 2,(ix),l", 0xdd, 0xcb, 0x00, 0xd5);
    testCodeEmit("set 2,(ix+6),l", 0xdd, 0xcb, 0x06, 0xd5);
    testCodeEmit("set 2,(ix-#0c),l", 0xdd, 0xcb, 0xf4, 0xd5);
    testCodeEmit("set 2,(ix)", 0xdd, 0xcb, 0x00, 0xd6);
    testCodeEmit("set 2,(ix+6)", 0xdd, 0xcb, 0x06, 0xd6);
    testCodeEmit("set 2,(ix-#0c)", 0xdd, 0xcb, 0xf4, 0xd6);
    testCodeEmit("set 2,(ix),a", 0xdd, 0xcb, 0x00, 0xd7);
    testCodeEmit("set 2,(ix+6),a", 0xdd, 0xcb, 0x06, 0xd7);
    testCodeEmit("set 2,(ix-#0c),a", 0xdd, 0xcb, 0xf4, 0xd7);

    testCodeEmit("set 3,(ix),b", 0xdd, 0xcb, 0x00, 0xd8);
    testCodeEmit("set 3,(ix+6),b", 0xdd, 0xcb, 0x06, 0xd8);
    testCodeEmit("set 3,(ix-#0c),b", 0xdd, 0xcb, 0xf4, 0xd8);
    testCodeEmit("set 3,(ix),c", 0xdd, 0xcb, 0x00, 0xd9);
    testCodeEmit("set 3,(ix+6),c", 0xdd, 0xcb, 0x06, 0xd9);
    testCodeEmit("set 3,(ix-#0c),c", 0xdd, 0xcb, 0xf4, 0xd9);
    testCodeEmit("set 3,(ix),d", 0xdd, 0xcb, 0x00, 0xda);
    testCodeEmit("set 3,(ix+6),d", 0xdd, 0xcb, 0x06, 0xda);
    testCodeEmit("set 3,(ix-#0c),d", 0xdd, 0xcb, 0xf4, 0xda);
    testCodeEmit("set 3,(ix),e", 0xdd, 0xcb, 0x00, 0xdb);
    testCodeEmit("set 3,(ix+6),e", 0xdd, 0xcb, 0x06, 0xdb);
    testCodeEmit("set 3,(ix-#0c),e", 0xdd, 0xcb, 0xf4, 0xdb);
    testCodeEmit("set 3,(ix),h", 0xdd, 0xcb, 0x00, 0xdc);
    testCodeEmit("set 3,(ix+6),h", 0xdd, 0xcb, 0x06, 0xdc);
    testCodeEmit("set 3,(ix-#0c),h", 0xdd, 0xcb, 0xf4, 0xdc);
    testCodeEmit("set 3,(ix),l", 0xdd, 0xcb, 0x00, 0xdd);
    testCodeEmit("set 3,(ix+6),l", 0xdd, 0xcb, 0x06, 0xdd);
    testCodeEmit("set 3,(ix-#0c),l", 0xdd, 0xcb, 0xf4, 0xdd);
    testCodeEmit("set 3,(ix)", 0xdd, 0xcb, 0x00, 0xde);
    testCodeEmit("set 3,(ix+6)", 0xdd, 0xcb, 0x06, 0xde);
    testCodeEmit("set 3,(ix-#0c)", 0xdd, 0xcb, 0xf4, 0xde);
    testCodeEmit("set 3,(ix),a", 0xdd, 0xcb, 0x00, 0xdf);
    testCodeEmit("set 3,(ix+6),a", 0xdd, 0xcb, 0x06, 0xdf);
    testCodeEmit("set 3,(ix-#0c),a", 0xdd, 0xcb, 0xf4, 0xdf);

    testCodeEmit("set 4,(ix),b", 0xdd, 0xcb, 0x00, 0xe0);
    testCodeEmit("set 4,(ix+6),b", 0xdd, 0xcb, 0x06, 0xe0);
    testCodeEmit("set 4,(ix-#0c),b", 0xdd, 0xcb, 0xf4, 0xe0);
    testCodeEmit("set 4,(ix),c", 0xdd, 0xcb, 0x00, 0xe1);
    testCodeEmit("set 4,(ix+6),c", 0xdd, 0xcb, 0x06, 0xe1);
    testCodeEmit("set 4,(ix-#0c),c", 0xdd, 0xcb, 0xf4, 0xe1);
    testCodeEmit("set 4,(ix),d", 0xdd, 0xcb, 0x00, 0xe2);
    testCodeEmit("set 4,(ix+6),d", 0xdd, 0xcb, 0x06, 0xe2);
    testCodeEmit("set 4,(ix-#0c),d", 0xdd, 0xcb, 0xf4, 0xe2);
    testCodeEmit("set 4,(ix),e", 0xdd, 0xcb, 0x00, 0xe3);
    testCodeEmit("set 4,(ix+6),e", 0xdd, 0xcb, 0x06, 0xe3);
    testCodeEmit("set 4,(ix-#0c),e", 0xdd, 0xcb, 0xf4, 0xe3);
    testCodeEmit("set 4,(ix),h", 0xdd, 0xcb, 0x00, 0xe4);
    testCodeEmit("set 4,(ix+6),h", 0xdd, 0xcb, 0x06, 0xe4);
    testCodeEmit("set 4,(ix-#0c),h", 0xdd, 0xcb, 0xf4, 0xe4);
    testCodeEmit("set 4,(ix),l", 0xdd, 0xcb, 0x00, 0xe5);
    testCodeEmit("set 4,(ix+6),l", 0xdd, 0xcb, 0x06, 0xe5);
    testCodeEmit("set 4,(ix-#0c),l", 0xdd, 0xcb, 0xf4, 0xe5);
    testCodeEmit("set 4,(ix)", 0xdd, 0xcb, 0x00, 0xe6);
    testCodeEmit("set 4,(ix+6)", 0xdd, 0xcb, 0x06, 0xe6);
    testCodeEmit("set 4,(ix-#0c)", 0xdd, 0xcb, 0xf4, 0xe6);
    testCodeEmit("set 4,(ix),a", 0xdd, 0xcb, 0x00, 0xe7);
    testCodeEmit("set 4,(ix+6),a", 0xdd, 0xcb, 0x06, 0xe7);
    testCodeEmit("set 4,(ix-#0c),a", 0xdd, 0xcb, 0xf4, 0xe7);

    testCodeEmit("set 5,(ix),b", 0xdd, 0xcb, 0x00, 0xe8);
    testCodeEmit("set 5,(ix+6),b", 0xdd, 0xcb, 0x06, 0xe8);
    testCodeEmit("set 5,(ix-#0c),b", 0xdd, 0xcb, 0xf4, 0xe8);
    testCodeEmit("set 5,(ix),c", 0xdd, 0xcb, 0x00, 0xe9);
    testCodeEmit("set 5,(ix+6),c", 0xdd, 0xcb, 0x06, 0xe9);
    testCodeEmit("set 5,(ix-#0c),c", 0xdd, 0xcb, 0xf4, 0xe9);
    testCodeEmit("set 5,(ix),d", 0xdd, 0xcb, 0x00, 0xea);
    testCodeEmit("set 5,(ix+6),d", 0xdd, 0xcb, 0x06, 0xea);
    testCodeEmit("set 5,(ix-#0c),d", 0xdd, 0xcb, 0xf4, 0xea);
    testCodeEmit("set 5,(ix),e", 0xdd, 0xcb, 0x00, 0xeb);
    testCodeEmit("set 5,(ix+6),e", 0xdd, 0xcb, 0x06, 0xeb);
    testCodeEmit("set 5,(ix-#0c),e", 0xdd, 0xcb, 0xf4, 0xeb);
    testCodeEmit("set 5,(ix),h", 0xdd, 0xcb, 0x00, 0xec);
    testCodeEmit("set 5,(ix+6),h", 0xdd, 0xcb, 0x06, 0xec);
    testCodeEmit("set 5,(ix-#0c),h", 0xdd, 0xcb, 0xf4, 0xec);
    testCodeEmit("set 5,(ix),l", 0xdd, 0xcb, 0x00, 0xed);
    testCodeEmit("set 5,(ix+6),l", 0xdd, 0xcb, 0x06, 0xed);
    testCodeEmit("set 5,(ix-#0c),l", 0xdd, 0xcb, 0xf4, 0xed);
    testCodeEmit("set 5,(ix)", 0xdd, 0xcb, 0x00, 0xee);
    testCodeEmit("set 5,(ix+6)", 0xdd, 0xcb, 0x06, 0xee);
    testCodeEmit("set 5,(ix-#0c)", 0xdd, 0xcb, 0xf4, 0xee);
    testCodeEmit("set 5,(ix),a", 0xdd, 0xcb, 0x00, 0xef);
    testCodeEmit("set 5,(ix+6),a", 0xdd, 0xcb, 0x06, 0xef);
    testCodeEmit("set 5,(ix-#0c),a", 0xdd, 0xcb, 0xf4, 0xef);

    testCodeEmit("set 6,(ix),b", 0xdd, 0xcb, 0x00, 0xf0);
    testCodeEmit("set 6,(ix+6),b", 0xdd, 0xcb, 0x06, 0xf0);
    testCodeEmit("set 6,(ix-#0c),b", 0xdd, 0xcb, 0xf4, 0xf0);
    testCodeEmit("set 6,(ix),c", 0xdd, 0xcb, 0x00, 0xf1);
    testCodeEmit("set 6,(ix+6),c", 0xdd, 0xcb, 0x06, 0xf1);
    testCodeEmit("set 6,(ix-#0c),c", 0xdd, 0xcb, 0xf4, 0xf1);
    testCodeEmit("set 6,(ix),d", 0xdd, 0xcb, 0x00, 0xf2);
    testCodeEmit("set 6,(ix+6),d", 0xdd, 0xcb, 0x06, 0xf2);
    testCodeEmit("set 6,(ix-#0c),d", 0xdd, 0xcb, 0xf4, 0xf2);
    testCodeEmit("set 6,(ix),e", 0xdd, 0xcb, 0x00, 0xf3);
    testCodeEmit("set 6,(ix+6),e", 0xdd, 0xcb, 0x06, 0xf3);
    testCodeEmit("set 6,(ix-#0c),e", 0xdd, 0xcb, 0xf4, 0xf3);
    testCodeEmit("set 6,(ix),h", 0xdd, 0xcb, 0x00, 0xf4);
    testCodeEmit("set 6,(ix+6),h", 0xdd, 0xcb, 0x06, 0xf4);
    testCodeEmit("set 6,(ix-#0c),h", 0xdd, 0xcb, 0xf4, 0xf4);
    testCodeEmit("set 6,(ix),l", 0xdd, 0xcb, 0x00, 0xf5);
    testCodeEmit("set 6,(ix+6),l", 0xdd, 0xcb, 0x06, 0xf5);
    testCodeEmit("set 6,(ix-#0c),l", 0xdd, 0xcb, 0xf4, 0xf5);
    testCodeEmit("set 6,(ix)", 0xdd, 0xcb, 0x00, 0xf6);
    testCodeEmit("set 6,(ix+6)", 0xdd, 0xcb, 0x06, 0xf6);
    testCodeEmit("set 6,(ix-#0c)", 0xdd, 0xcb, 0xf4, 0xf6);
    testCodeEmit("set 6,(ix),a", 0xdd, 0xcb, 0x00, 0xf7);
    testCodeEmit("set 6,(ix+6),a", 0xdd, 0xcb, 0x06, 0xf7);
    testCodeEmit("set 6,(ix-#0c),a", 0xdd, 0xcb, 0xf4, 0xf7);

    testCodeEmit("set 7,(ix),b", 0xdd, 0xcb, 0x00, 0xf8);
    testCodeEmit("set 7,(ix+6),b", 0xdd, 0xcb, 0x06, 0xf8);
    testCodeEmit("set 7,(ix-#0c),b", 0xdd, 0xcb, 0xf4, 0xf8);
    testCodeEmit("set 7,(ix),c", 0xdd, 0xcb, 0x00, 0xf9);
    testCodeEmit("set 7,(ix+6),c", 0xdd, 0xcb, 0x06, 0xf9);
    testCodeEmit("set 7,(ix-#0c),c", 0xdd, 0xcb, 0xf4, 0xf9);
    testCodeEmit("set 7,(ix),d", 0xdd, 0xcb, 0x00, 0xfa);
    testCodeEmit("set 7,(ix+6),d", 0xdd, 0xcb, 0x06, 0xfa);
    testCodeEmit("set 7,(ix-#0c),d", 0xdd, 0xcb, 0xf4, 0xfa);
    testCodeEmit("set 7,(ix),e", 0xdd, 0xcb, 0x00, 0xfb);
    testCodeEmit("set 7,(ix+6),e", 0xdd, 0xcb, 0x06, 0xfb);
    testCodeEmit("set 7,(ix-#0c),e", 0xdd, 0xcb, 0xf4, 0xfb);
    testCodeEmit("set 7,(ix),h", 0xdd, 0xcb, 0x00, 0xfc);
    testCodeEmit("set 7,(ix+6),h", 0xdd, 0xcb, 0x06, 0xfc);
    testCodeEmit("set 7,(ix-#0c),h", 0xdd, 0xcb, 0xf4, 0xfc);
    testCodeEmit("set 7,(ix),l", 0xdd, 0xcb, 0x00, 0xfd);
    testCodeEmit("set 7,(ix+6),l", 0xdd, 0xcb, 0x06, 0xfd);
    testCodeEmit("set 7,(ix-#0c),l", 0xdd, 0xcb, 0xf4, 0xfd);
    testCodeEmit("set 7,(ix)", 0xdd, 0xcb, 0x00, 0xfe);
    testCodeEmit("set 7,(ix+6)", 0xdd, 0xcb, 0x06, 0xfe);
    testCodeEmit("set 7,(ix-#0c)", 0xdd, 0xcb, 0xf4, 0xfe);
    testCodeEmit("set 7,(ix),a", 0xdd, 0xcb, 0x00, 0xff);
    testCodeEmit("set 7,(ix+6),a", 0xdd, 0xcb, 0x06, 0xff);
    testCodeEmit("set 7,(ix-#0c),a", 0xdd, 0xcb, 0xf4, 0xff);

    testCodeEmit("set 0,(iy),b", 0xFD, 0xCB, 0x00, 0xC0);
    testCodeEmit("set 0,(iy+6),b", 0xFD, 0xCB, 0x06, 0xC0);
    testCodeEmit("set 0,(iy-#0c),b", 0xFD, 0xCB, 0xF4, 0xC0);
    testCodeEmit("set 0,(iy),c", 0xFD, 0xCB, 0x00, 0xC1);
    testCodeEmit("set 0,(iy+6),c", 0xFD, 0xCB, 0x06, 0xC1);
    testCodeEmit("set 0,(iy-#0c),c", 0xFD, 0xCB, 0xF4, 0xC1);
    testCodeEmit("set 0,(iy),d", 0xFD, 0xCB, 0x00, 0xC2);
    testCodeEmit("set 0,(iy+6),d", 0xFD, 0xCB, 0x06, 0xC2);
    testCodeEmit("set 0,(iy-#0c),d", 0xFD, 0xCB, 0xF4, 0xC2);
    testCodeEmit("set 0,(iy),e", 0xFD, 0xCB, 0x00, 0xC3);
    testCodeEmit("set 0,(iy+6),e", 0xFD, 0xCB, 0x06, 0xC3);
    testCodeEmit("set 0,(iy-#0c),e", 0xFD, 0xCB, 0xF4, 0xC3);
    testCodeEmit("set 0,(iy),h", 0xFD, 0xCB, 0x00, 0xC4);
    testCodeEmit("set 0,(iy+6),h", 0xFD, 0xCB, 0x06, 0xC4);
    testCodeEmit("set 0,(iy-#0c),h", 0xFD, 0xCB, 0xF4, 0xC4);
    testCodeEmit("set 0,(iy),l", 0xFD, 0xCB, 0x00, 0xC5);
    testCodeEmit("set 0,(iy+6),l", 0xFD, 0xCB, 0x06, 0xC5);
    testCodeEmit("set 0,(iy-#0c),l", 0xFD, 0xCB, 0xF4, 0xC5);
    testCodeEmit("set 0,(iy)", 0xFD, 0xCB, 0x00, 0xC6);
    testCodeEmit("set 0,(iy+6)", 0xFD, 0xCB, 0x06, 0xC6);
    testCodeEmit("set 0,(iy-#0c)", 0xFD, 0xCB, 0xF4, 0xC6);
    testCodeEmit("set 0,(iy),a", 0xFD, 0xCB, 0x00, 0xC7);
    testCodeEmit("set 0,(iy+6),a", 0xFD, 0xCB, 0x06, 0xC7);
    testCodeEmit("set 0,(iy-#0c),a", 0xFD, 0xCB, 0xF4, 0xC7);

    testCodeEmit("set 1,(iy),b", 0xFD, 0xCB, 0x00, 0xC8);
    testCodeEmit("set 1,(iy+6),b", 0xFD, 0xCB, 0x06, 0xC8);
    testCodeEmit("set 1,(iy-#0c),b", 0xFD, 0xCB, 0xF4, 0xC8);
    testCodeEmit("set 1,(iy),c", 0xFD, 0xCB, 0x00, 0xC9);
    testCodeEmit("set 1,(iy+6),c", 0xFD, 0xCB, 0x06, 0xC9);
    testCodeEmit("set 1,(iy-#0c),c", 0xFD, 0xCB, 0xF4, 0xC9);
    testCodeEmit("set 1,(iy),d", 0xFD, 0xCB, 0x00, 0xCA);
    testCodeEmit("set 1,(iy+6),d", 0xFD, 0xCB, 0x06, 0xCA);
    testCodeEmit("set 1,(iy-#0c),d", 0xFD, 0xCB, 0xF4, 0xCA);
    testCodeEmit("set 1,(iy),e", 0xFD, 0xCB, 0x00, 0xCB);
    testCodeEmit("set 1,(iy+6),e", 0xFD, 0xCB, 0x06, 0xCB);
    testCodeEmit("set 1,(iy-#0c),e", 0xFD, 0xCB, 0xF4, 0xCB);
    testCodeEmit("set 1,(iy),h", 0xFD, 0xCB, 0x00, 0xCC);
    testCodeEmit("set 1,(iy+6),h", 0xFD, 0xCB, 0x06, 0xCC);
    testCodeEmit("set 1,(iy-#0c),h", 0xFD, 0xCB, 0xF4, 0xCC);
    testCodeEmit("set 1,(iy),l", 0xFD, 0xCB, 0x00, 0xCD);
    testCodeEmit("set 1,(iy+6),l", 0xFD, 0xCB, 0x06, 0xCD);
    testCodeEmit("set 1,(iy-#0c),l", 0xFD, 0xCB, 0xF4, 0xCD);
    testCodeEmit("set 1,(iy)", 0xFD, 0xCB, 0x00, 0xCE);
    testCodeEmit("set 1,(iy+6)", 0xFD, 0xCB, 0x06, 0xCE);
    testCodeEmit("set 1,(iy-#0c)", 0xFD, 0xCB, 0xF4, 0xCE);
    testCodeEmit("set 1,(iy),a", 0xFD, 0xCB, 0x00, 0xCF);
    testCodeEmit("set 1,(iy+6),a", 0xFD, 0xCB, 0x06, 0xCF);
    testCodeEmit("set 1,(iy-#0c),a", 0xFD, 0xCB, 0xF4, 0xCF);

    testCodeEmit("set 2,(iy),b", 0xFD, 0xCB, 0x00, 0xD0);
    testCodeEmit("set 2,(iy+6),b", 0xFD, 0xCB, 0x06, 0xD0);
    testCodeEmit("set 2,(iy-#0c),b", 0xFD, 0xCB, 0xF4, 0xD0);
    testCodeEmit("set 2,(iy),c", 0xFD, 0xCB, 0x00, 0xD1);
    testCodeEmit("set 2,(iy+6),c", 0xFD, 0xCB, 0x06, 0xD1);
    testCodeEmit("set 2,(iy-#0c),c", 0xFD, 0xCB, 0xF4, 0xD1);
    testCodeEmit("set 2,(iy),d", 0xFD, 0xCB, 0x00, 0xD2);
    testCodeEmit("set 2,(iy+6),d", 0xFD, 0xCB, 0x06, 0xD2);
    testCodeEmit("set 2,(iy-#0c),d", 0xFD, 0xCB, 0xF4, 0xD2);
    testCodeEmit("set 2,(iy),e", 0xFD, 0xCB, 0x00, 0xD3);
    testCodeEmit("set 2,(iy+6),e", 0xFD, 0xCB, 0x06, 0xD3);
    testCodeEmit("set 2,(iy-#0c),e", 0xFD, 0xCB, 0xF4, 0xD3);
    testCodeEmit("set 2,(iy),h", 0xFD, 0xCB, 0x00, 0xD4);
    testCodeEmit("set 2,(iy+6),h", 0xFD, 0xCB, 0x06, 0xD4);
    testCodeEmit("set 2,(iy-#0c),h", 0xFD, 0xCB, 0xF4, 0xD4);
    testCodeEmit("set 2,(iy),l", 0xFD, 0xCB, 0x00, 0xD5);
    testCodeEmit("set 2,(iy+6),l", 0xFD, 0xCB, 0x06, 0xD5);
    testCodeEmit("set 2,(iy-#0c),l", 0xFD, 0xCB, 0xF4, 0xD5);
    testCodeEmit("set 2,(iy)", 0xFD, 0xCB, 0x00, 0xD6);
    testCodeEmit("set 2,(iy+6)", 0xFD, 0xCB, 0x06, 0xD6);
    testCodeEmit("set 2,(iy-#0c)", 0xFD, 0xCB, 0xF4, 0xD6);
    testCodeEmit("set 2,(iy),a", 0xFD, 0xCB, 0x00, 0xD7);
    testCodeEmit("set 2,(iy+6),a", 0xFD, 0xCB, 0x06, 0xD7);
    testCodeEmit("set 2,(iy-#0c),a", 0xFD, 0xCB, 0xF4, 0xD7);

    testCodeEmit("set 3,(iy),b", 0xFD, 0xCB, 0x00, 0xD8);
    testCodeEmit("set 3,(iy+6),b", 0xFD, 0xCB, 0x06, 0xD8);
    testCodeEmit("set 3,(iy-#0c),b", 0xFD, 0xCB, 0xF4, 0xD8);
    testCodeEmit("set 3,(iy),c", 0xFD, 0xCB, 0x00, 0xD9);
    testCodeEmit("set 3,(iy+6),c", 0xFD, 0xCB, 0x06, 0xD9);
    testCodeEmit("set 3,(iy-#0c),c", 0xFD, 0xCB, 0xF4, 0xD9);
    testCodeEmit("set 3,(iy),d", 0xFD, 0xCB, 0x00, 0xDA);
    testCodeEmit("set 3,(iy+6),d", 0xFD, 0xCB, 0x06, 0xDA);
    testCodeEmit("set 3,(iy-#0c),d", 0xFD, 0xCB, 0xF4, 0xDA);
    testCodeEmit("set 3,(iy),e", 0xFD, 0xCB, 0x00, 0xDB);
    testCodeEmit("set 3,(iy+6),e", 0xFD, 0xCB, 0x06, 0xDB);
    testCodeEmit("set 3,(iy-#0c),e", 0xFD, 0xCB, 0xF4, 0xDB);
    testCodeEmit("set 3,(iy),h", 0xFD, 0xCB, 0x00, 0xDC);
    testCodeEmit("set 3,(iy+6),h", 0xFD, 0xCB, 0x06, 0xDC);
    testCodeEmit("set 3,(iy-#0c),h", 0xFD, 0xCB, 0xF4, 0xDC);
    testCodeEmit("set 3,(iy),l", 0xFD, 0xCB, 0x00, 0xDD);
    testCodeEmit("set 3,(iy+6),l", 0xFD, 0xCB, 0x06, 0xDD);
    testCodeEmit("set 3,(iy-#0c),l", 0xFD, 0xCB, 0xF4, 0xDD);
    testCodeEmit("set 3,(iy)", 0xFD, 0xCB, 0x00, 0xDE);
    testCodeEmit("set 3,(iy+6)", 0xFD, 0xCB, 0x06, 0xDE);
    testCodeEmit("set 3,(iy-#0c)", 0xFD, 0xCB, 0xF4, 0xDE);
    testCodeEmit("set 3,(iy),a", 0xFD, 0xCB, 0x00, 0xDF);
    testCodeEmit("set 3,(iy+6),a", 0xFD, 0xCB, 0x06, 0xDF);
    testCodeEmit("set 3,(iy-#0c),a", 0xFD, 0xCB, 0xF4, 0xDF);

    testCodeEmit("set 4,(iy),b", 0xFD, 0xCB, 0x00, 0xE0);
    testCodeEmit("set 4,(iy+6),b", 0xFD, 0xCB, 0x06, 0xE0);
    testCodeEmit("set 4,(iy-#0c),b", 0xFD, 0xCB, 0xF4, 0xE0);
    testCodeEmit("set 4,(iy),c", 0xFD, 0xCB, 0x00, 0xE1);
    testCodeEmit("set 4,(iy+6),c", 0xFD, 0xCB, 0x06, 0xE1);
    testCodeEmit("set 4,(iy-#0c),c", 0xFD, 0xCB, 0xF4, 0xE1);
    testCodeEmit("set 4,(iy),d", 0xFD, 0xCB, 0x00, 0xE2);
    testCodeEmit("set 4,(iy+6),d", 0xFD, 0xCB, 0x06, 0xE2);
    testCodeEmit("set 4,(iy-#0c),d", 0xFD, 0xCB, 0xF4, 0xE2);
    testCodeEmit("set 4,(iy),e", 0xFD, 0xCB, 0x00, 0xE3);
    testCodeEmit("set 4,(iy+6),e", 0xFD, 0xCB, 0x06, 0xE3);
    testCodeEmit("set 4,(iy-#0c),e", 0xFD, 0xCB, 0xF4, 0xE3);
    testCodeEmit("set 4,(iy),h", 0xFD, 0xCB, 0x00, 0xE4);
    testCodeEmit("set 4,(iy+6),h", 0xFD, 0xCB, 0x06, 0xE4);
    testCodeEmit("set 4,(iy-#0c),h", 0xFD, 0xCB, 0xF4, 0xE4);
    testCodeEmit("set 4,(iy),l", 0xFD, 0xCB, 0x00, 0xE5);
    testCodeEmit("set 4,(iy+6),l", 0xFD, 0xCB, 0x06, 0xE5);
    testCodeEmit("set 4,(iy-#0c),l", 0xFD, 0xCB, 0xF4, 0xE5);
    testCodeEmit("set 4,(iy)", 0xFD, 0xCB, 0x00, 0xE6);
    testCodeEmit("set 4,(iy+6)", 0xFD, 0xCB, 0x06, 0xE6);
    testCodeEmit("set 4,(iy-#0c)", 0xFD, 0xCB, 0xF4, 0xE6);
    testCodeEmit("set 4,(iy),a", 0xFD, 0xCB, 0x00, 0xE7);
    testCodeEmit("set 4,(iy+6),a", 0xFD, 0xCB, 0x06, 0xE7);
    testCodeEmit("set 4,(iy-#0c),a", 0xFD, 0xCB, 0xF4, 0xE7);

    testCodeEmit("set 5,(iy),b", 0xFD, 0xCB, 0x00, 0xE8);
    testCodeEmit("set 5,(iy+6),b", 0xFD, 0xCB, 0x06, 0xE8);
    testCodeEmit("set 5,(iy-#0c),b", 0xFD, 0xCB, 0xF4, 0xE8);
    testCodeEmit("set 5,(iy),c", 0xFD, 0xCB, 0x00, 0xE9);
    testCodeEmit("set 5,(iy+6),c", 0xFD, 0xCB, 0x06, 0xE9);
    testCodeEmit("set 5,(iy-#0c),c", 0xFD, 0xCB, 0xF4, 0xE9);
    testCodeEmit("set 5,(iy),d", 0xFD, 0xCB, 0x00, 0xEA);
    testCodeEmit("set 5,(iy+6),d", 0xFD, 0xCB, 0x06, 0xEA);
    testCodeEmit("set 5,(iy-#0c),d", 0xFD, 0xCB, 0xF4, 0xEA);
    testCodeEmit("set 5,(iy),e", 0xFD, 0xCB, 0x00, 0xEB);
    testCodeEmit("set 5,(iy+6),e", 0xFD, 0xCB, 0x06, 0xEB);
    testCodeEmit("set 5,(iy-#0c),e", 0xFD, 0xCB, 0xF4, 0xEB);
    testCodeEmit("set 5,(iy),h", 0xFD, 0xCB, 0x00, 0xEC);
    testCodeEmit("set 5,(iy+6),h", 0xFD, 0xCB, 0x06, 0xEC);
    testCodeEmit("set 5,(iy-#0c),h", 0xFD, 0xCB, 0xF4, 0xEC);
    testCodeEmit("set 5,(iy),l", 0xFD, 0xCB, 0x00, 0xED);
    testCodeEmit("set 5,(iy+6),l", 0xFD, 0xCB, 0x06, 0xED);
    testCodeEmit("set 5,(iy-#0c),l", 0xFD, 0xCB, 0xF4, 0xED);
    testCodeEmit("set 5,(iy)", 0xFD, 0xCB, 0x00, 0xEE);
    testCodeEmit("set 5,(iy+6)", 0xFD, 0xCB, 0x06, 0xEE);
    testCodeEmit("set 5,(iy-#0c)", 0xFD, 0xCB, 0xF4, 0xEE);
    testCodeEmit("set 5,(iy),a", 0xFD, 0xCB, 0x00, 0xEF);
    testCodeEmit("set 5,(iy+6),a", 0xFD, 0xCB, 0x06, 0xEF);
    testCodeEmit("set 5,(iy-#0c),a", 0xFD, 0xCB, 0xF4, 0xEF);

    testCodeEmit("set 6,(iy),b", 0xFD, 0xCB, 0x00, 0xF0);
    testCodeEmit("set 6,(iy+6),b", 0xFD, 0xCB, 0x06, 0xF0);
    testCodeEmit("set 6,(iy-#0c),b", 0xFD, 0xCB, 0xF4, 0xF0);
    testCodeEmit("set 6,(iy),c", 0xFD, 0xCB, 0x00, 0xF1);
    testCodeEmit("set 6,(iy+6),c", 0xFD, 0xCB, 0x06, 0xF1);
    testCodeEmit("set 6,(iy-#0c),c", 0xFD, 0xCB, 0xF4, 0xF1);
    testCodeEmit("set 6,(iy),d", 0xFD, 0xCB, 0x00, 0xF2);
    testCodeEmit("set 6,(iy+6),d", 0xFD, 0xCB, 0x06, 0xF2);
    testCodeEmit("set 6,(iy-#0c),d", 0xFD, 0xCB, 0xF4, 0xF2);
    testCodeEmit("set 6,(iy),e", 0xFD, 0xCB, 0x00, 0xF3);
    testCodeEmit("set 6,(iy+6),e", 0xFD, 0xCB, 0x06, 0xF3);
    testCodeEmit("set 6,(iy-#0c),e", 0xFD, 0xCB, 0xF4, 0xF3);
    testCodeEmit("set 6,(iy),h", 0xFD, 0xCB, 0x00, 0xF4);
    testCodeEmit("set 6,(iy+6),h", 0xFD, 0xCB, 0x06, 0xF4);
    testCodeEmit("set 6,(iy-#0c),h", 0xFD, 0xCB, 0xF4, 0xF4);
    testCodeEmit("set 6,(iy),l", 0xFD, 0xCB, 0x00, 0xF5);
    testCodeEmit("set 6,(iy+6),l", 0xFD, 0xCB, 0x06, 0xF5);
    testCodeEmit("set 6,(iy-#0c),l", 0xFD, 0xCB, 0xF4, 0xF5);
    testCodeEmit("set 6,(iy)", 0xFD, 0xCB, 0x00, 0xF6);
    testCodeEmit("set 6,(iy+6)", 0xFD, 0xCB, 0x06, 0xF6);
    testCodeEmit("set 6,(iy-#0c)", 0xFD, 0xCB, 0xF4, 0xF6);
    testCodeEmit("set 6,(iy),a", 0xFD, 0xCB, 0x00, 0xF7);
    testCodeEmit("set 6,(iy+6),a", 0xFD, 0xCB, 0x06, 0xF7);
    testCodeEmit("set 6,(iy-#0c),a", 0xFD, 0xCB, 0xF4, 0xF7);

    testCodeEmit("set 7,(iy),b", 0xFD, 0xCB, 0x00, 0xF8);
    testCodeEmit("set 7,(iy+6),b", 0xFD, 0xCB, 0x06, 0xF8);
    testCodeEmit("set 7,(iy-#0c),b", 0xFD, 0xCB, 0xF4, 0xF8);
    testCodeEmit("set 7,(iy),c", 0xFD, 0xCB, 0x00, 0xF9);
    testCodeEmit("set 7,(iy+6),c", 0xFD, 0xCB, 0x06, 0xF9);
    testCodeEmit("set 7,(iy-#0c),c", 0xFD, 0xCB, 0xF4, 0xF9);
    testCodeEmit("set 7,(iy),d", 0xFD, 0xCB, 0x00, 0xFA);
    testCodeEmit("set 7,(iy+6),d", 0xFD, 0xCB, 0x06, 0xFA);
    testCodeEmit("set 7,(iy-#0c),d", 0xFD, 0xCB, 0xF4, 0xFA);
    testCodeEmit("set 7,(iy),e", 0xFD, 0xCB, 0x00, 0xFB);
    testCodeEmit("set 7,(iy+6),e", 0xFD, 0xCB, 0x06, 0xFB);
    testCodeEmit("set 7,(iy-#0c),e", 0xFD, 0xCB, 0xF4, 0xFB);
    testCodeEmit("set 7,(iy),h", 0xFD, 0xCB, 0x00, 0xFC);
    testCodeEmit("set 7,(iy+6),h", 0xFD, 0xCB, 0x06, 0xFC);
    testCodeEmit("set 7,(iy-#0c),h", 0xFD, 0xCB, 0xF4, 0xFC);
    testCodeEmit("set 7,(iy),l", 0xFD, 0xCB, 0x00, 0xFD);
    testCodeEmit("set 7,(iy+6),l", 0xFD, 0xCB, 0x06, 0xFD);
    testCodeEmit("set 7,(iy-#0c),l", 0xFD, 0xCB, 0xF4, 0xFD);
    testCodeEmit("set 7,(iy)", 0xFD, 0xCB, 0x00, 0xFE);
    testCodeEmit("set 7,(iy+6)", 0xFD, 0xCB, 0x06, 0xFE);
    testCodeEmit("set 7,(iy-#0c)", 0xFD, 0xCB, 0xF4, 0xFE);
    testCodeEmit("set 7,(iy),a", 0xFD, 0xCB, 0x00, 0xFF);
    testCodeEmit("set 7,(iy+6),a", 0xFD, 0xCB, 0x06, 0xFF);
    testCodeEmit("set 7,(iy-#0c),a", 0xFD, 0xCB, 0xF4, 0xFF);

  });
});
