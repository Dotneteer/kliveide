<!DOCTYPE html>
<html lang="en-US">

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,maximum-scale=2">
    <link rel="stylesheet" type="text/css" media="screen" href="/kliveide/assets/css/semantic.min.css">
    <link rel="stylesheet" type="text/css" media="screen" href="/kliveide/assets/css/style.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto:400,700&amp;subset=latin-ext" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,700&amp;subset=latin-ext" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Ubuntu+Mono:400,700&amp;subset=latin-ext" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Lato:300,300i,400,400i,700,700i" rel="stylesheet">

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Watch Expressions | Klive IDE</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Watch Expressions" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Although its name suggests that the Watch Memory window can display only values in the memory, the capabilities of this tool are richer." />
<meta property="og:description" content="Although its name suggests that the Watch Memory window can display only values in the memory, the capabilities of this tool are richer." />
<link rel="canonical" href="http://localhost:4000/kliveide/documents/watch-expressions" />
<meta property="og:url" content="http://localhost:4000/kliveide/documents/watch-expressions" />
<meta property="og:site_name" content="Klive IDE" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-01-03T00:00:00+01:00" />
<script type="application/ld+json">
{"@type":"BlogPosting","headline":"Watch Expressions","dateModified":"2019-01-03T00:00:00+01:00","datePublished":"2019-01-03T00:00:00+01:00","url":"http://localhost:4000/kliveide/documents/watch-expressions","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/kliveide/documents/watch-expressions"},"description":"Although its name suggests that the Watch Memory window can display only values in the memory, the capabilities of this tool are richer.","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  </head>

  <body>

    <!-- Header -->
    <div class="ui vertical stripe segment with-header-back">
      <div class="ui container high">
        <h1 class="ui header">Klive IDE</h1>
        <h3 class="ui header">Full-fledged ZX Spectrum IDE with Electron, VS Code</h2>
      </div>
    </div>

    <!-- Menu -->
    <div class="ui vertical stripe segment with-menu-back">
      <div class="ui container">
        <div class="ui menu with-menu-back">
          <a class="item" href="/kliveide/">Home</a>
          <a class=" item" href="/kliveide/getting-started/install-kliveide.html">Getting Started</a>
          <a class=" active  item" href="/kliveide/documents/main-features.html">Documents</a>
          <a class="item" href="/kliveide/spectrum/basic-toc.html">ZX Spectrum</a>
          <a class="item" target="_blank" href="https://github.com/Dotneteer/kliveide">GitHub</a>
        </div>
      </div>
    </div>

    <div class="ui vertical stripe segment with-content-back">
      <div class="ui container">
        <div class="ui grid">
          <div class="three wide computer sixteen wide mobile column">
            <div class="document-list">
              
              
              
              
              
                
                  
                  
                  
                  
                  <div class="document-category  collapsed " onclick="handleClick(this)">
                    <span class="category-name">Z80 Assembler</span>
                    <div class="extender  collapsed ">
                      <svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 10 16" >
                        <path d="M10 10l-1.5 1.5L5 7.75 1.5 11.5 0 10l5-5z" />
                      </svg>
                    </div>
                  </div>
                  <div class="article-names  hidden ">
                  
                    
                  
                    
                    <a id="main-features" class="" href="/kliveide/documents/main-features#article">Main Features</a>
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                    <a id="how-assembler-works" class="" href="/kliveide/documents/how-assembler-works#article">How the assembler works</a>
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                    <a id="language-structure" class="" href="/kliveide/documents/language-structure#article">Language structure</a>
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                    <a id="labels" class="" href="/kliveide/documents/labels-and-symbols#article">Labels and Symbols</a>
                      
                      
                      
                    
                  
                    
                  
                    
                    <a id="expressions" class="" href="/kliveide/documents/expressions#article">Expressions</a>
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                    <a id="instructions" class="" href="/kliveide/documents/z80-instructions#article">Z80 Instructions</a>
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                    <a id="pragmas" class="" href="/kliveide/documents/pragmas#article">Pragmas</a>
                      
                      
                      
                    
                  
                    
                  
                    
                    <a id="statements" class="" href="/kliveide/documents/statements#article">Statements</a>
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                    <a id="macros" class="" href="/kliveide/documents/macros#article">Macros</a>
                      
                      
                      
                    
                  
                    
                  
                    
                    <a id="directives" class="" href="/kliveide/documents/directives#article">Directives</a>
                      
                      
                      
                    
                  
                    
                  
                    
                    <a id="modules" class="" href="/kliveide/documents/modules#article">Modules</a>
                      
                      
                      
                    
                  
                    
                  
                    
                    <a id="structs" class="" href="/kliveide/documents/structs#article">Structures</a>
                      
                      
                      
                    
                  
                    
                    <a id="assembler-output" class="" href="/kliveide/documents/assembler-output#article">Assembler Output</a>
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                  </div>
                  
                
                  
                  
                  
                  
                
                  
                  
                  
                  
                  <div class="document-category  expanded " onclick="handleClick(this)">
                    <span class="category-name">Tool Commands</span>
                    <div class="extender  expanded ">
                      <svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 10 16" >
                        <path d="M10 10l-1.5 1.5L5 7.75 1.5 11.5 0 10l5-5z" />
                      </svg>
                    </div>
                  </div>
                  <div class="article-names  displayed ">
                  
                    
                  
                    
                  
                    
                  
                    
                    <a id="tool-overview" class="" href="/kliveide/documents/tool-overview#article">Overview</a>
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                    <a id="memory-commands" class="" href="/kliveide/documents/common-commands#article">Common Commands</a>
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                  
                    
                    <a id="memory-section-commands" class="" href="/kliveide/documents/memory-section-commands#article">Disassembly: Memory Sections</a>
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                    <a id="annotation-commands" class="" href="/kliveide/documents/annotation-commands#article">Disassembly: Annotations</a>
                      
                      
                      
                    
                  
                    
                    <a id="breakpoint-commands" class="" href="/kliveide/documents/breakpoint-commands#article">Disassembly: Breakpoints</a>
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                  
                    
                    <a id="miscellaneous-commands" class="" href="/kliveide/documents/miscellaneous-commands#article">Disassembly: Miscellaneous</a>
                      
                      
                      
                    
                  
                    
                    <a id="watch-commands" class="" href="/kliveide/documents/tape-explorer-commands#article">Tape Explorer Commands</a>
                      
                      
                      
                    
                  
                    
                  
                    
                    <a id="watch-commands" class="" href="/kliveide/documents/watch-commands#article">Watch Commands</a>
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                  
                    
                    <a id="watch-expressions" class=" active " href="/kliveide/documents/watch-expressions#article">Watch Expressions</a>
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                    <a id="watch-samples" class="" href="/kliveide/documents/watch-samples#article">Watch Samples</a>
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                  </div>
                  
                
                  
                  
                  
                  
                
                  
                  
                  
                  
                  <div class="document-category  collapsed " onclick="handleClick(this)">
                    <span class="category-name">Scripting</span>
                    <div class="extender  collapsed ">
                      <svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 10 16" >
                        <path d="M10 10l-1.5 1.5L5 7.75 1.5 11.5 0 10l5-5z" />
                      </svg>
                    </div>
                  </div>
                  <div class="article-names  hidden ">
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                    <a id="scripting-overview" class="" href="/kliveide/documents/scripting-overview#article">Overview</a>
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                    <a id="scripting-object-model" class="" href="/kliveide/documents/scripting-object-model#article">Scripting Object Model</a>
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                    <a id="scripting-vms" class="" href="/kliveide/documents/scripting-vms#article">Managing Virtual machines</a>
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                  
                    
                    <a id="scripting-z80" class="" href="/kliveide/documents/scripting-z80#article">Scripting the Z80 CPU</a>
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                    <a id="scripting-screen" class="" href="/kliveide/documents/scripting-screen#article">Scripting the Screen</a>
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                  
                    
                    <a id="scripting-memory" class="" href="/kliveide/documents/scripting-memory#article">Scripting the Memory</a>
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                    <a id="scripting-audio" class="" href="/kliveide/documents/scripting-audio#article">Scripting the Audio</a>
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                  </div>
                  
                
                  
                  
                  
                  
                  <div class="document-category  collapsed " onclick="handleClick(this)">
                    <span class="category-name">Unit Testing</span>
                    <div class="extender  collapsed ">
                      <svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 10 16" >
                        <path d="M10 10l-1.5 1.5L5 7.75 1.5 11.5 0 10l5-5z" />
                      </svg>
                    </div>
                  </div>
                  <div class="article-names  hidden ">
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                    <a id="unit-testing-basics" class="" href="/kliveide/documents/unit-testing-basics#article">Syntax Basics</a>
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                    <a id="unit-testing-expressions" class="" href="/kliveide/documents/unit-testing-expressions#article">Expressions</a>
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                    <a id="unit-testing-details" class="" href="/kliveide/documents/unit-testing-details#article">Detailed Syntax</a>
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                  
                    
                    <a id="unit-testing-process" class="" href="/kliveide/documents/unit-testing-process#article">The Testing Process</a>
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                  </div>
                  
                
                  
                  
                  
                  
                
            </div>
          </div>
          <div class="thirteen wide computer sixteen wide mobile column with-main-back">
            <div id="#article" class="main-title-area">
              <h1>Tool Commands &raquo; Watch Expressions</h1>
            </div>
            <div class="main-content-area">
              <p>Although its name suggests that the Watch Memory window can display only values in the memory, the capabilities of this
tool are richer.</p>

<p>You can define <em>watch expressions</em> and define their <em>display format</em>. For example, if you want to display for consecutive
bytes in the memory pointed by the HL register in bitvector format (32 bits), you can do this with this command:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>+ [HL :DW] :%32
</code></pre></div></div>

<p>Later, you need to display the 16-bit value in the memory address pointed by HL plus BC. You can use this command:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>+ [HL + BC :W] :W
</code></pre></div></div>

<p>Watch expressions are arithmetic expression using C-like expression syntax. The engine behind the Watch Memory window
continuously evalutes these expressions, formats them and displays their values.</p>

<h2 id="expression-types">Expression Types</h2>

<p>When working with expressions, the engine uses for integral types, and automatically converts them:</p>
<ul>
  <li><strong>Boolean</strong>: Simple <code class="highlighter-rouge">TRUE</code> or <code class="highlighter-rouge">FALSE</code>. Any non-zero value is converted to <code class="highlighter-rouge">TRUE</code>, zero is <code class="highlighter-rouge">FALSE</code>.</li>
  <li><strong>Byte</strong>: 8-bit unsigned value</li>
  <li><strong>Word</strong>: 16-bit unsigned value</li>
  <li><strong>Double word</strong>: 32-bit unsigned value</li>
</ul>

<p>When working with values, the expression engine automatically converts operation result to keep all valuable bits.
For example, when you multiply two bytes, the result will be a word. Multiplying a byte and a word results a double word.
Nonetheless, when you multiply two double words, the result will be a double word, so only the last 32 bits are kept.</p>

<p>Comparisons and other logical operations result in booleans.</p>

<blockquote>
  <p>You do not need to deal with types, the evaluation engine does it for you. Sometimes you need signed types. With the
help of the <code class="highlighter-rouge">:-B</code>, <code class="highlighter-rouge">:-W</code>, and <code class="highlighter-rouge">:-DW</code> format specifiers, as you will learn later, you can display values in signed form.</p>
</blockquote>

<h2 id="value-sources">Value Sources</h2>

<p>You have several value sources that you can use in expressions:</p>
<ul>
  <li>Literal values (decimal, hexadecimal, binary, character)</li>
  <li>Compilation symbols</li>
  <li>Z80 register values</li>
  <li>Z80 CPU flag values</li>
  <li>ZX Spectrum memory contents</li>
</ul>

<blockquote>
  <p>In the future you may use ULA-specific values, or memory values of non-paged memory banks.</p>
</blockquote>

<h2 id="literals">Literals</h2>

<p>The expression syntax provides these types of literals:</p>
<ul>
  <li>
    <p><strong>Decimal numbers.</strong> You can use up to 5 digits (0..9) to declare a decimal number. Examples:
16, 32768, 2354.</p>
  </li>
  <li>
    <p><strong>Hexadecimal numbers.</strong> You can use up to 4 hexadecimal digits (0..9, a..f or A..F) to declare
a hexadecimal literal. The engine recognizes one of the <code class="highlighter-rouge">#</code> <code class="highlighter-rouge">0x</code> or <code class="highlighter-rouge">$</code> prefix, or one of 
the <code class="highlighter-rouge">h</code> or <code class="highlighter-rouge">H</code> suffixes. If you use the <code class="highlighter-rouge">h</code> or <code class="highlighter-rouge">H</code>
suffixes, the hexadecimal number should start with a decimal digit <code class="highlighter-rouge">0</code>…<code class="highlighter-rouge">9</code>.</p>
  </li>
</ul>

<p>Here are a few samples:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#12AC
0x12ac
$12Ac
12ACh
12acH
0AC34H
</code></pre></div></div>

<ul>
  <li><strong>Binary numbers.</strong> Literal starting with the one of the <code class="highlighter-rouge">%</code> or <code class="highlighter-rouge">0b</code> prefix are taken into 
account as binary literals. You can follow the prefix with up to 16 <code class="highlighter-rouge">0</code> or <code class="highlighter-rouge">1</code> digits. To make
them more readable, you can separate adjacent digits with the underscore (<code class="highlighter-rouge">_</code>) character. These 
are all valid binary literals:</li>
</ul>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>%01011111
0b01011111
0b_0101_1111
</code></pre></div></div>

<blockquote>
  <p>You can use negative number with the minus sign in front of them. Actually, the sign is not
the part of the numeric literal, it is an operator.</p>
</blockquote>

<ul>
  <li><strong>Characters</strong>. You can put a character between single quotes (for example: <code class="highlighter-rouge">'Q'</code>).</li>
</ul>

<p>You can use escape sequences to define non-visible or control characters:</p>

<table>
  <thead>
    <tr>
      <th>Escape</th>
      <th>Code</th>
      <th>Character</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">\i</code></td>
      <td>0x10</td>
      <td>INK</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">\p</code></td>
      <td>0x11</td>
      <td>PAPER</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">\f</code></td>
      <td>0x12</td>
      <td>FLASH</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">\b</code></td>
      <td>0x13</td>
      <td>BRIGHT</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">\I</code></td>
      <td>0x14</td>
      <td>INVERSE</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">\o</code></td>
      <td>0x15</td>
      <td>OVER</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">\a</code></td>
      <td>0x16</td>
      <td>AT</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">\t</code></td>
      <td>0x17</td>
      <td>TAB</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">\P</code></td>
      <td>0x60</td>
      <td>pound sign</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">\C</code></td>
      <td>0x7F</td>
      <td>copyright sign</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">\\</code></td>
      <td>0x5C</td>
      <td>backslash</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">\'</code></td>
      <td>0x27</td>
      <td>single quote</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">\"</code></td>
      <td>0x22</td>
      <td>double quote</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">\0</code></td>
      <td>0x00</td>
      <td>binary zero</td>
    </tr>
  </tbody>
</table>

<p>To declare a character by its binary code, you can use the <code class="highlighter-rouge">\xH</code> or<br />
<code class="highlighter-rouge">\xHH</code> sequences (<code class="highlighter-rouge">H</code> is a hexadecimal digit). For example, these
escape sequence pairs are equivalent:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>'\i'
'\x10'
</code></pre></div></div>

<h3 id="symbols">Symbols</h3>

<p>You can use symbols to refer to labels and other constants used in Z80 programs. Identifiers must start with 
a letter (a..z or A..Z) or the underscore character (<code class="highlighter-rouge">_</code>). The subsequent characters 
letters, digits, or underscores. Here are a few samples:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>MyCycle
ERR_NO
Cycle_4_Wait  
</code></pre></div></div>
<blockquote>
  <p>There are strings that can be both identifiers or hexadecimal literals with the <code class="highlighter-rouge">H</code> or <code class="highlighter-rouge">h</code> suffix, like
<code class="highlighter-rouge">AC0Fh</code> or <code class="highlighter-rouge">FADH</code>. The engine considers such strings as symbols. To use hexadecimal literal, use a <code class="highlighter-rouge">0</code>
prefix: <code class="highlighter-rouge">0FADH</code> is a hexadecimal literal, while <code class="highlighter-rouge">FADH</code> is an identifier.</p>
</blockquote>

<p>The engine usus the symbols within the Z80 program you compile, inject, run or debug.</p>

<blockquote>
  <p>The SpecteNetIde Z80 Assembler handles symbols with string values. These symbols retrieve
0 (word) value.</p>
</blockquote>

<h3 id="z80-registers">Z80 Registers</h3>

<p>The expression engine recognizes the standard 8-bit and 16-bit register names, as specified in the official 
Zilog Z80 documentation:</p>

<ul>
  <li>8-bit registers: <code class="highlighter-rouge">A</code>, <code class="highlighter-rouge">B</code>, <code class="highlighter-rouge">C</code>, <code class="highlighter-rouge">D</code>, <code class="highlighter-rouge">E</code>, <code class="highlighter-rouge">H</code>, <code class="highlighter-rouge">L</code>, <code class="highlighter-rouge">I</code>, <code class="highlighter-rouge">R</code></li>
  <li>16-bit registers: <code class="highlighter-rouge">AF</code>, <code class="highlighter-rouge">BC</code>, <code class="highlighter-rouge">DE</code>, <code class="highlighter-rouge">HL</code>, <code class="highlighter-rouge">SP</code>, <code class="highlighter-rouge">IX</code>, <code class="highlighter-rouge">IY</code></li>
  <li>For the 8-bit halves of the <code class="highlighter-rouge">IX</code> and <code class="highlighter-rouge">IY</code> index registers, the engine uses these names:
<code class="highlighter-rouge">XL</code>, <code class="highlighter-rouge">XH</code>, <code class="highlighter-rouge">YL</code>, <code class="highlighter-rouge">YH</code>. Alternatively, the compiler accepts these names, too: 
<code class="highlighter-rouge">IXL</code>, <code class="highlighter-rouge">IXH</code>, <code class="highlighter-rouge">IYL</code>, <code class="highlighter-rouge">IYH</code>. As a kind of exception to general naming conventions, 
these mixed-case names are also accepted: <code class="highlighter-rouge">IXl</code>, <code class="highlighter-rouge">IXh</code>, <code class="highlighter-rouge">IYl</code>, <code class="highlighter-rouge">IYh</code>.</li>
  <li>The engine recognizes the <code class="highlighter-rouge">WZ</code> (internal Z80 register, not accessible programmatically) register, too.</li>
</ul>

<h3 id="z80-flags">Z80 Flags</h3>

<p>The expression engine can access the Z80 CPU flags individually, and it also has tokens for the inverted flag values:</p>

<table>
  <thead>
    <tr>
      <th>Token</th>
      <th>Flag</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>` <strong>P</strong></td>
      <td>True, if <strong>S</strong> flag (Bit 7) is set</td>
    </tr>
    <tr>
      <td>` <strong>M</strong></td>
      <td>True, if <strong>S</strong> flag (Bit 7) is reset</td>
    </tr>
    <tr>
      <td>` <strong>Z</strong></td>
      <td>True, if <strong>Z</strong> flag (Bit 6) is set</td>
    </tr>
    <tr>
      <td>` <strong>NZ</strong></td>
      <td>True, if <strong>Z</strong> flag (Bit 6) is reset</td>
    </tr>
    <tr>
      <td>` <strong>5</strong></td>
      <td>True, if <strong>R5</strong> flag (Bit 5) is set</td>
    </tr>
    <tr>
      <td>` <strong>N5</strong></td>
      <td>True, if <strong>R5</strong> flag (Bit 5) is reset</td>
    </tr>
    <tr>
      <td>` <strong>H</strong></td>
      <td>True, if <strong>H</strong> flag (Bit 4) is set</td>
    </tr>
    <tr>
      <td>` <strong>NH</strong></td>
      <td>True, if <strong>H</strong> flag (Bit 4) is reset</td>
    </tr>
    <tr>
      <td>` <strong>3</strong></td>
      <td>True, if <strong>R3</strong> flag (Bit 3) is set</td>
    </tr>
    <tr>
      <td>` <strong>N3</strong></td>
      <td>True, if <strong>R3</strong> flag (Bit 3) is reset</td>
    </tr>
    <tr>
      <td>` <strong>PE</strong></td>
      <td>True, if <strong>PV</strong> flag (Bit 2) is set</td>
    </tr>
    <tr>
      <td>` <strong>PO</strong></td>
      <td>True, if <strong>PV</strong> flag (Bit 2) is reset</td>
    </tr>
    <tr>
      <td>` <strong>N</strong></td>
      <td>True, if <strong>N</strong> flag (Bit 1) is set</td>
    </tr>
    <tr>
      <td>` <strong>NN</strong></td>
      <td>True, if <strong>N</strong> flag (Bit 1) is reset</td>
    </tr>
    <tr>
      <td>` <strong>C</strong></td>
      <td>True, if <strong>C</strong> flag (Bit 0) is set</td>
    </tr>
    <tr>
      <td>` <strong>NC</strong></td>
      <td>True, if <strong>C</strong> flag (Bit 0) is reset</td>
    </tr>
  </tbody>
</table>

<h3 id="zx-spectrum-memory-contents">ZX Spectrum Memory Contents</h3>

<p>You can query the entire 64K memory available by the Z80 CPU. With a memory indirection expression, 
you can query byte, word, and double word values, respectively:</p>

<p><strong><code class="highlighter-rouge">[</code></strong> <code class="highlighter-rouge">expression</code> [<code class="highlighter-rouge">access specifier</code>] <strong><code class="highlighter-rouge">]</code></strong></p>

<p>You wrap an <em>expression</em> and an optional <em>access specifier</em> between square brackets. 
The expression specifies the memory address, the <em>access specifier</em> sets the number of bytes to
query from the memory:</p>

<ul>
  <li><strong><code class="highlighter-rouge">:B</code></strong> — A single byte stored in the specified memory address.</li>
  <li><strong><code class="highlighter-rouge">:W</code></strong> — Two consequtive bytes stored in the specified address and the next one.</li>
  <li><strong><code class="highlighter-rouge">:DW</code></strong> — Four consequtive bytes stored in the specified memory address and the next three.</li>
</ul>

<p>If you omit the access specifier, the default is <code class="highlighter-rouge">:B</code>.</p>

<p>When you query multiple bytes from the memory, the first byte is the LSB (least significant byte), 
the last is the MSB (most significant byte). Lets assume, you store these four bytes at the address #4000:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#12, #4A, #C3, #78
</code></pre></div></div>
<ul>
  <li>The <code class="highlighter-rouge">[#4000]</code> (and <code class="highlighter-rouge">[#4000:B]</code>) expressions retrieve <code class="highlighter-rouge">#12</code>.</li>
  <li>The <code class="highlighter-rouge">[#4000:W]</code> expression results in <code class="highlighter-rouge">#4A12</code> (16 bits).</li>
  <li>The <code class="highlighter-rouge">[#4000:DW]</code> expression results in <code class="highlighter-rouge">#78C34A12</code> (32 bits).</li>
</ul>

<h2 id="operators">Operators</h2>

<p>You can use about a dozen operators, including unary, binary and ternary ones. In this section
you will learn about them. I will introduce them in descending order of their precendence.</p>

<h3 id="conditional-operator">Conditional Operator</h3>

<p>The engine supports using only one ternary operator, the conditional operator:</p>

<p><em>conditional-expression</em> <strong><code class="highlighter-rouge">?</code></strong> <em>true-value</em> <strong><code class="highlighter-rouge">:</code></strong> <em>false-value</em></p>

<p>This operation results in -1:</p>

<p><code class="highlighter-rouge">2 &gt; 3 ? 2 : -1</code></p>

<p>When <em>conditional-expression</em> evaluates to true, the operation results 
in <em>true-value</em>; otherwise in <em>false-value</em>.</p>

<blockquote>
  <p>Conditional expressions are evaluated from right to left, in contrast to binary operators,
which use left-to-right evaluation.</p>
</blockquote>

<h3 id="binary-bitwise-operators">Binary Bitwise Operators</h3>

<table>
  <thead>
    <tr>
      <th>Operator token</th>
      <th>Precedence</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">|</code></td>
      <td>1</td>
      <td>Bitwise OR</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">^</code></td>
      <td>2</td>
      <td>Bitwise XOR</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">&amp;</code></td>
      <td>3</td>
      <td>Bitwise AND</td>
    </tr>
  </tbody>
</table>

<h3 id="relational-operators">Relational Operators</h3>

<table>
  <thead>
    <tr>
      <th>Operator token</th>
      <th>Precedence</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">==</code></td>
      <td>4</td>
      <td>Equality</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">!=</code></td>
      <td>4</td>
      <td>Non-equality</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">&lt;</code></td>
      <td>5</td>
      <td>Less than</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">&lt;=</code></td>
      <td>5</td>
      <td>Less than or equal</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">&gt;</code></td>
      <td>5</td>
      <td>Greater than</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">&gt;=</code></td>
      <td>5</td>
      <td>Greater than or equal</td>
    </tr>
  </tbody>
</table>

<h3 id="shift-operators">Shift Operators</h3>

<p>The bits of the left operand are shifted by the number of bits given by the right operand.</p>

<table>
  <thead>
    <tr>
      <th>Operator token</th>
      <th>Precedence</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">&lt;&lt;</code></td>
      <td>6</td>
      <td>Shift left</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">&gt;&gt;</code></td>
      <td>6</td>
      <td>Shift right</td>
    </tr>
  </tbody>
</table>

<h3 id="basic-arithmetic-operators">Basic Arithmetic Operators</h3>

<table>
  <thead>
    <tr>
      <th>Operator token</th>
      <th>Precedence</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">+</code></td>
      <td>7</td>
      <td>Addition</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">-</code></td>
      <td>7</td>
      <td>Subtraction</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">*</code></td>
      <td>8</td>
      <td>Multiplication</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">/</code></td>
      <td>8</td>
      <td>Division</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">%</code></td>
      <td>8</td>
      <td>Modulo calculation</td>
    </tr>
  </tbody>
</table>

<h3 id="unary-operators">Unary operators</h3>

<table>
  <thead>
    <tr>
      <th>Operator token</th>
      <th>Precedence</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">+</code></td>
      <td>9</td>
      <td>Unary plus</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">-</code></td>
      <td>9</td>
      <td>Unary minus</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">~</code></td>
      <td>9</td>
      <td>Unary bitwise NOT</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">!</code></td>
      <td>9</td>
      <td>Unary logical NOT</td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p>Do not forget, you can change the default precendence with <code class="highlighter-rouge">(</code> and <code class="highlighter-rouge">)</code>, for example:
<code class="highlighter-rouge">(4 + 2) * 3</code>.</p>
</blockquote>

<h2 id="format-specifiers">Format Specifiers</h2>

<p>With format specifiers, you can declare how would you like to display the results of watch expressions.
These are optional, if you do not use them, the engine will select the format according to the type of 
the expressions’s value:</p>

<ul>
  <li>Boolean values — <strong><code class="highlighter-rouge">:F</code></strong> format</li>
  <li>Byte values — <strong><code class="highlighter-rouge">:B</code></strong> format</li>
  <li>Word values — <strong><code class="highlighter-rouge">:W</code></strong> format</li>
  <li>Double word values — <strong><code class="highlighter-rouge">:DW</code></strong> format</li>
</ul>

<p>This table lists the format specifiers supported by the watch engine:</p>

<table>
  <thead>
    <tr>
      <th>Specifier</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong><code class="highlighter-rouge">:F</code></strong></td>
      <td>Flag format. When the value is zero, the output is <code class="highlighter-rouge">FALSE</code>; otherwise, <code class="highlighter-rouge">TRUE</code>.</td>
    </tr>
    <tr>
      <td><strong><code class="highlighter-rouge">:B</code></strong></td>
      <td>Byte format. The engine displays both the hexadecimal value in two hexadecimal digits, plus the decimal value. For example: <code class="highlighter-rouge">#7C (124)</code></td>
    </tr>
    <tr>
      <td><strong><code class="highlighter-rouge">:-B</code></strong></td>
      <td>Signed byte format. Similar to <strong><code class="highlighter-rouge">:B</code></strong>, nonetheless, the decimal value is signed. For example, <code class="highlighter-rouge">#FE (-2)</code></td>
    </tr>
    <tr>
      <td><strong><code class="highlighter-rouge">:C</code></strong></td>
      <td>Character format. The value is converted to a byte, and the ASCII character value of the byte is displayed. When the character code is between 32 and 126, the character is displayed, otherwise a hexadecimal character escape is used. For example, <code class="highlighter-rouge">#41</code> results in <strong><code class="highlighter-rouge">'A'</code></strong>, while <code class="highlighter-rouge">#8D</code> in <code class="highlighter-rouge">'\0x8D'</code>.</td>
    </tr>
    <tr>
      <td><strong><code class="highlighter-rouge">:W</code></strong></td>
      <td>Word format. The engine displays both the hexadecimal value in four hexadecimal digits, plus the decimal value. For example: <code class="highlighter-rouge">#317C (12668)</code></td>
    </tr>
    <tr>
      <td><strong><code class="highlighter-rouge">:-W</code></strong></td>
      <td>Signed word format. Similar to <strong><code class="highlighter-rouge">:W</code></strong>, nonetheless, the decimal value is signed. For example, <code class="highlighter-rouge">#FFFE (-2)</code></td>
    </tr>
    <tr>
      <td><strong><code class="highlighter-rouge">:DW</code></strong></td>
      <td>Double word format. The engine displays both the hexadecimal value in eight hexadecimal digits, plus the decimal value. For example: <code class="highlighter-rouge">#43CA317C (‭1137324412‬)</code></td>
    </tr>
    <tr>
      <td><strong><code class="highlighter-rouge">:-DW</code></strong></td>
      <td>Signed double word format. Similar to <strong><code class="highlighter-rouge">:DW</code></strong>, nonetheless, the decimal value is signed. For example, <code class="highlighter-rouge">#FFFFFFFE (-2)</code></td>
    </tr>
    <tr>
      <td><strong><code class="highlighter-rouge">:H4</code></strong></td>
      <td>4 hexadecimal digits. The result is converted to a word and displayed in hexadecimal format, bytes in LSB/MSB order. For example, <code class="highlighter-rouge">#4F3C</code> results in <code class="highlighter-rouge">#3C #4F</code>.</td>
    </tr>
    <tr>
      <td><strong><code class="highlighter-rouge">:H8</code></strong></td>
      <td>8 hexadecimal digits. The result is converted to a double word and displayed in hexadecimal format, bytes in LSB/MSB order. For example, <code class="highlighter-rouge">#67D24F3C</code> results in <code class="highlighter-rouge">#3C #4F #D2 #67</code>.</td>
    </tr>
    <tr>
      <td><strong><code class="highlighter-rouge">:%8</code></strong></td>
      <td>8 binary digits. The result is converted to a byte and displayed in binary format. For example, <code class="highlighter-rouge">#4F</code> results in <code class="highlighter-rouge">01001111</code>.</td>
    </tr>
    <tr>
      <td><strong><code class="highlighter-rouge">:%16</code></strong></td>
      <td>16 binary digits. The result is converted to a word and displayed in binary format, bytes in MSB/LSB order. For example, <code class="highlighter-rouge">#324F</code> results in <code class="highlighter-rouge">00110010 01001111</code>.</td>
    </tr>
    <tr>
      <td><strong><code class="highlighter-rouge">:%32</code></strong></td>
      <td>32 binary digits. The result is converted to a double word and displayed in binary format, bytes in MSB/LSB order. For example, <code class="highlighter-rouge">#AA55324F</code> results in <code class="highlighter-rouge">10101010 01010101 00110010 01001111</code>.</td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p>In the future, the list of format specifiers may extend.</p>
</blockquote>

<p>Please note, while <strong><code class="highlighter-rouge">:H4</code></strong> and <strong><code class="highlighter-rouge">:H8</code></strong> use LSB/MSB byte order, <strong><code class="highlighter-rouge">:%8</code></strong>, <strong><code class="highlighter-rouge">:%16</code></strong>,
and <strong><code class="highlighter-rouge">:%32</code></strong> apply MSB/LSB order. You may use the <strong><code class="highlighter-rouge">:H4</code></strong> and <strong><code class="highlighter-rouge">:H8</code></strong> formats to display memory
contents in the order of bytes as they are stored in the memory. Lets assume, you store these
four bytes at the address #4000:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#12, #4A, #C3, #78
</code></pre></div></div>

<p>This is how watch expressions display the content:</p>

<ul>
  <li><code class="highlighter-rouge">[#4000]</code> — <code class="highlighter-rouge">#12 (18)</code></li>
  <li><code class="highlighter-rouge">[#4000:B]</code> — <code class="highlighter-rouge">#12 (18)</code></li>
  <li><code class="highlighter-rouge">[#4000:B] :H4</code> — <code class="highlighter-rouge">#12 #00</code> (Do not forget, the expression reads only a single byte from the memory!)</li>
  <li><code class="highlighter-rouge">[#4000:W]</code> — <code class="highlighter-rouge">#4A12 (18962)</code> (This expression reads two bytes from the memory)</li>
  <li><code class="highlighter-rouge">[#4000:W] :H4</code> — <code class="highlighter-rouge">#12 #4A</code> (This expression reads two bytes from the memory)</li>
  <li><code class="highlighter-rouge">[#4000:DW]</code> — <code class="highlighter-rouge">#78C34A12 (‭2026064402‬)</code> (This expression reads four bytes from the memory)</li>
  <li><code class="highlighter-rouge">[#4000:DW] :H8</code> — <code class="highlighter-rouge">#12 #4A #C3 #78</code> (This expression reads four bytes from the memory)</li>
</ul>

            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer  -->
    <div class="ui vertical stripe segment with-header-back">
        <footer class="ui container">
          <p>&copy; Istvan Novak, 2020</p>
        </footer>
      </div>
  
    <!-- Floating return to top button -->
    <a href="javascript:" id="return-to-top">
      <span>
        <svg width="32" height="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 10 16">
          <path d="M10 10l-1.5 1.5L5 7.75 1.5 11.5 0 10l5-5z"/>
        </svg>
      </span>
    </a>
    
    <!-- Floating go to previous button -->
    <a href="/kliveide/documents/watch-commands#article" id="go-to-prev">
      <span>
        <svg width="32" height="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 10 16" transform="rotate(-90)">
          <path d="M10 10l-1.5 1.5L5 7.75 1.5 11.5 0 10l5-5z"/>
        </svg>
      </span>
    </a>
    
    
    <!-- Floating go to next button -->
    <a href="/kliveide/documents/watch-samples#article" id="go-to-next">
      <span>
        <svg width="32" height="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 10 16" transform="rotate(90)">
          <path d="M10 10l-1.5 1.5L5 7.75 1.5 11.5 0 10l5-5z"/>
        </svg>
      </span>
    </a>
    

    <script>
      window.addEventListener("scroll", function(){
        var scrolled = window.pageYOffset > 50;
        document.getElementById("return-to-top").style.display = scrolled ? "block" : "none";
        var prevEl = document.getElementById("go-to-prev");
        if (prevEl) prevEl.style.display = scrolled ? "block" : "none";
        var nextEl = document.getElementById("go-to-next");
        if (nextEl) nextEl.style.display = scrolled ? "block" : "none";
      });
      var intervalId = 0;
      var $scrollButton = document.querySelector('#return-to-top');
      function scrollStep() {
        if (window.pageYOffset === 0) {
          clearInterval(intervalId);
        }
        window.scroll(0, window.pageYOffset - 50);
      }
      function scrollToTop() {
        intervalId = setInterval(scrollStep, 6.66);
      }
      $scrollButton.addEventListener('click', scrollToTop);

      function handleClick(arg) {
        var nextEl = arg.nextElementSibling;
        var extEl = arg.children[1];
        if (arg.classList.contains("expanded")) {
          arg.classList.remove("expanded");
          arg.classList.add("collapsed");
          extEl.classList.remove("expanded");
          extEl.classList.add("collapsed");
          nextEl.classList.remove("displayed")
          nextEl.classList.add("hidden")
        } else {
          arg.classList.remove("collapsed");
          arg.classList.add("expanded");
          extEl.classList.remove("collapsed");
          extEl.classList.add("expanded");
          nextEl.classList.remove("hidden")
          nextEl.classList.add("displayed")
        }
      }
    </script>

    
  </body>
</html>