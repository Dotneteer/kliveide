<!DOCTYPE html>
<html lang="en-US">

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,maximum-scale=2">
    <link rel="stylesheet" type="text/css" media="screen" href="/kliveide/assets/css/semantic.min.css">
    <link rel="stylesheet" type="text/css" media="screen" href="/kliveide/assets/css/style.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto:400,700&amp;subset=latin-ext" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,700&amp;subset=latin-ext" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Ubuntu+Mono:400,700&amp;subset=latin-ext" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Lato:300,300i,400,400i,700,700i" rel="stylesheet">

    <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Scripting Object Model | Klive IDE</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Scripting Object Model" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="SpectNetIde offers a set of .NET objects that you can use to create scripts that automate everyday tasks with ZX Spectrum virtual machines. You can use these objects in any .NET Framework application, or in scripting languages that allow accessing .NET Framework objects." />
<meta property="og:description" content="SpectNetIde offers a set of .NET objects that you can use to create scripts that automate everyday tasks with ZX Spectrum virtual machines. You can use these objects in any .NET Framework application, or in scripting languages that allow accessing .NET Framework objects." />
<link rel="canonical" href="http://localhost:4000/kliveide/documents/scripting-object-model" />
<meta property="og:url" content="http://localhost:4000/kliveide/documents/scripting-object-model" />
<meta property="og:site_name" content="Klive IDE" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-01-04T00:00:00+01:00" />
<script type="application/ld+json">
{"@type":"BlogPosting","url":"http://localhost:4000/kliveide/documents/scripting-object-model","headline":"Scripting Object Model","dateModified":"2019-01-04T00:00:00+01:00","datePublished":"2019-01-04T00:00:00+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/kliveide/documents/scripting-object-model"},"description":"SpectNetIde offers a set of .NET objects that you can use to create scripts that automate everyday tasks with ZX Spectrum virtual machines. You can use these objects in any .NET Framework application, or in scripting languages that allow accessing .NET Framework objects.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  </head>

  <body>

    <!-- Header -->
    <div class="ui vertical stripe segment with-header-back">
      <div class="ui container high">
        <h1 class="ui header">Klive IDE</h1>
        <h3 class="ui header">Full-fledged ZX Spectrum IDE with Electron, VS Code</h2>
      </div>
    </div>

    <!-- Menu -->
    <div class="ui vertical stripe segment with-menu-back">
      <div class="ui container">
        <div class="ui menu with-menu-back">
          <a class="item" href="/kliveide/">Home</a>
          <a class=" item" href="/kliveide/getting-started/install-kliveide.html">Getting Started</a>
          <a class=" active  item" href="/kliveide/documents/main-features.html">Documents</a>
          <a class="item" href="/kliveide/spectrum/basic-toc.html">ZX Spectrum</a>
          <a class="item" target="_blank" href="https://github.com/Dotneteer/kliveide">GitHub</a>
        </div>
      </div>
    </div>

    <div class="ui vertical stripe segment with-content-back">
      <div class="ui container">
        <div class="ui grid">
          <div class="three wide computer sixteen wide mobile column">
            <div class="document-list">
              
              
              
              
              
                
                  
                  
                  
                  
                  <div class="document-category  collapsed " onclick="handleClick(this)">
                    <span class="category-name">Z80 Assembler</span>
                    <div class="extender  collapsed ">
                      <svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 10 16" >
                        <path d="M10 10l-1.5 1.5L5 7.75 1.5 11.5 0 10l5-5z" />
                      </svg>
                    </div>
                  </div>
                  <div class="article-names  hidden ">
                  
                    
                  
                    
                    <a id="main-features" class="" href="/kliveide/documents/main-features#article">Main Features</a>
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                    <a id="how-assembler-works" class="" href="/kliveide/documents/how-assembler-works#article">How the assembler works</a>
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                    <a id="language-structure" class="" href="/kliveide/documents/language-structure#article">Language structure</a>
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                    <a id="labels" class="" href="/kliveide/documents/labels-and-symbols#article">Labels and Symbols</a>
                      
                      
                      
                    
                  
                    
                  
                    
                    <a id="expressions" class="" href="/kliveide/documents/expressions#article">Expressions</a>
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                    <a id="instructions" class="" href="/kliveide/documents/z80-instructions#article">Z80 Instructions</a>
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                    <a id="pragmas" class="" href="/kliveide/documents/pragmas#article">Pragmas</a>
                      
                      
                      
                    
                  
                    
                  
                    
                    <a id="statements" class="" href="/kliveide/documents/statements#article">Statements</a>
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                    <a id="macros" class="" href="/kliveide/documents/macros#article">Macros</a>
                      
                      
                      
                    
                  
                    
                  
                    
                    <a id="directives" class="" href="/kliveide/documents/directives#article">Directives</a>
                      
                      
                      
                    
                  
                    
                  
                    
                    <a id="modules" class="" href="/kliveide/documents/modules#article">Modules</a>
                      
                      
                      
                    
                  
                    
                  
                    
                    <a id="structs" class="" href="/kliveide/documents/structs#article">Structures</a>
                      
                      
                      
                    
                  
                    
                    <a id="assembler-output" class="" href="/kliveide/documents/assembler-output#article">Assembler Output</a>
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                  </div>
                  
                
                  
                  
                  
                  
                
                  
                  
                  
                  
                  <div class="document-category  collapsed " onclick="handleClick(this)">
                    <span class="category-name">Tool Commands</span>
                    <div class="extender  collapsed ">
                      <svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 10 16" >
                        <path d="M10 10l-1.5 1.5L5 7.75 1.5 11.5 0 10l5-5z" />
                      </svg>
                    </div>
                  </div>
                  <div class="article-names  hidden ">
                  
                    
                  
                    
                  
                    
                  
                    
                    <a id="tool-overview" class="" href="/kliveide/documents/tool-overview#article">Overview</a>
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                    <a id="memory-commands" class="" href="/kliveide/documents/common-commands#article">Common Commands</a>
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                  
                    
                    <a id="memory-section-commands" class="" href="/kliveide/documents/memory-section-commands#article">Disassembly: Memory Sections</a>
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                    <a id="annotation-commands" class="" href="/kliveide/documents/annotation-commands#article">Disassembly: Annotations</a>
                      
                      
                      
                    
                  
                    
                    <a id="breakpoint-commands" class="" href="/kliveide/documents/breakpoint-commands#article">Disassembly: Breakpoints</a>
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                  
                    
                    <a id="miscellaneous-commands" class="" href="/kliveide/documents/miscellaneous-commands#article">Disassembly: Miscellaneous</a>
                      
                      
                      
                    
                  
                    
                    <a id="watch-commands" class="" href="/kliveide/documents/tape-explorer-commands#article">Tape Explorer Commands</a>
                      
                      
                      
                    
                  
                    
                  
                    
                    <a id="watch-commands" class="" href="/kliveide/documents/watch-commands#article">Watch Commands</a>
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                  
                    
                    <a id="watch-expressions" class="" href="/kliveide/documents/watch-expressions#article">Watch Expressions</a>
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                    <a id="watch-samples" class="" href="/kliveide/documents/watch-samples#article">Watch Samples</a>
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                  </div>
                  
                
                  
                  
                  
                  
                
                  
                  
                  
                  
                  <div class="document-category  expanded " onclick="handleClick(this)">
                    <span class="category-name">Scripting</span>
                    <div class="extender  expanded ">
                      <svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 10 16" >
                        <path d="M10 10l-1.5 1.5L5 7.75 1.5 11.5 0 10l5-5z" />
                      </svg>
                    </div>
                  </div>
                  <div class="article-names  displayed ">
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                    <a id="scripting-overview" class="" href="/kliveide/documents/scripting-overview#article">Overview</a>
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                    <a id="scripting-object-model" class=" active " href="/kliveide/documents/scripting-object-model#article">Scripting Object Model</a>
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                    <a id="scripting-vms" class="" href="/kliveide/documents/scripting-vms#article">Managing Virtual machines</a>
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                  
                    
                    <a id="scripting-z80" class="" href="/kliveide/documents/scripting-z80#article">Scripting the Z80 CPU</a>
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                    <a id="scripting-screen" class="" href="/kliveide/documents/scripting-screen#article">Scripting the Screen</a>
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                  
                    
                    <a id="scripting-memory" class="" href="/kliveide/documents/scripting-memory#article">Scripting the Memory</a>
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                    <a id="scripting-audio" class="" href="/kliveide/documents/scripting-audio#article">Scripting the Audio</a>
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                  </div>
                  
                
                  
                  
                  
                  
                  <div class="document-category  collapsed " onclick="handleClick(this)">
                    <span class="category-name">Unit Testing</span>
                    <div class="extender  collapsed ">
                      <svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 10 16" >
                        <path d="M10 10l-1.5 1.5L5 7.75 1.5 11.5 0 10l5-5z" />
                      </svg>
                    </div>
                  </div>
                  <div class="article-names  hidden ">
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                    <a id="unit-testing-basics" class="" href="/kliveide/documents/unit-testing-basics#article">Syntax Basics</a>
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                    <a id="unit-testing-expressions" class="" href="/kliveide/documents/unit-testing-expressions#article">Expressions</a>
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                    <a id="unit-testing-details" class="" href="/kliveide/documents/unit-testing-details#article">Detailed Syntax</a>
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                  
                    
                    <a id="unit-testing-process" class="" href="/kliveide/documents/unit-testing-process#article">The Testing Process</a>
                      
                      
                      
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                    
                  
                  </div>
                  
                
                  
                  
                  
                  
                
            </div>
          </div>
          <div class="thirteen wide computer sixteen wide mobile column with-main-back">
            <div id="#article" class="main-title-area">
              <h1>Scripting &raquo; Scripting Object Model</h1>
            </div>
            <div class="main-content-area">
              <p><strong>SpectNetIde</strong> offers a set of .NET objects that you can use to create scripts that automate
everyday tasks with ZX Spectrum virtual machines. You can use these objects in any .NET Framework
application, or in scripting languages that allow accessing .NET Framework objects.</p>

<p>To use <strong>SpectNetIde</strong> scripting, add these assemblies to your projects:</p>

<table>
  <thead>
    <tr>
      <th>Assembly</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">Spect.Net.Assembler</code></td>
      <td>The Z80 Assembler of <strong>SpectNetIde</strong>. With the help of this component, you can use Z80 source code in scripts.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">Spect.Net.RomResources</code></td>
      <td>This assembly stores the ROMs of the Spectrum models supported by <strong>SpectNetIde</strong>.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">SpectNet.SpectrumEmu</code></td>
      <td>This assembly implements the ZX Spectrum emulator and the scripting object model.</td>
    </tr>
  </tbody>
</table>

<h2 id="zx-spectrum-virtual-machines">ZX Spectrum virtual machines</h2>

<p>The scripting object model supports these ZX Spectrum models:</p>
<ul>
  <li>ZX Spectrum 48K</li>
  <li>ZX Spectrum 128K</li>
  <li>ZX Spectrum +3E</li>
  <li><em>ZX Spectrum Next (still in development)</em></li>
</ul>

<p>The virtual machines use a background thread for their execution cycle. You can run the machine
with synchronous methods, but you need to pause or stop them, or waiting while their cycle completes
with the <code class="language-plaintext highlighter-rouge">async/await</code> pattern.</p>

<h2 id="scripting-objects">Scripting objects</h2>

<p>The table below contains a summary of the .NET types that constitute the ZX Spectrum scripting
object model. To get the shortest path to learn using them, I suggest starting with these documentations:</p>
<ul>
  <li><a href="/kliveide/documents/scripting-vms.html#the-spectrumvmfactory-class"><code class="language-plaintext highlighter-rouge">SpectrumVmFactory</code></a></li>
  <li><a href="/kliveide/documents/scripting-vms.html#the-spectrumvm-class"><code class="language-plaintext highlighter-rouge">SpectrumVm</code></a></li>
  <li><a href="/kliveide/documents/scripting-z80.html#the-cpuz80-class"><code class="language-plaintext highlighter-rouge">CpuZ80</code></a></li>
</ul>

<table>
  <thead>
    <tr>
      <th>Object type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><a href="/kliveide/documents/scripting-z80.html#the-addresstrackingstate-class"><code class="language-plaintext highlighter-rouge">AddressTrackingState</code></a></td>
      <td>This class represents tracking information regarding memory.</td>
    </tr>
    <tr>
      <td><a href="/kliveide/documents/scripting-vms.html#the-assembleroptions-class"><code class="language-plaintext highlighter-rouge">AssemblerOptions</code></a></td>
      <td>This class represents the options that can be used when the Z80 Assembler compiles the source code to machine code.</td>
    </tr>
    <tr>
      <td><a href="/kliveide/documents/scripting-audio.html#the-audiosamples-class"><code class="language-plaintext highlighter-rouge">AudioSamples</code></a></td>
      <td>This class stores audio samples for the currently rendered virtual machine frame.</td>
    </tr>
    <tr>
      <td><a href="/kliveide/documents/scripting-vms.html#the-codebreakpoints-class"><code class="language-plaintext highlighter-rouge">CodeBreakpoints</code></a></td>
      <td>Represents the breakpoint of the Spectrum virtual machine, at which execution should pause when running in debug mode.</td>
    </tr>
    <tr>
      <td><a href="/kliveide/documents/scripting-z80.html#the-cpuz80-class"><code class="language-plaintext highlighter-rouge">CpuZ80</code></a></td>
      <td>This class represents the Z80 CPU of a Spectrum virtual machine.</td>
    </tr>
    <tr>
      <td><a href="/kliveide/documents/scripting-vms.html#the-executecycleoptions-class"><code class="language-plaintext highlighter-rouge">ExecuteCycleOptions</code></a></td>
      <td>This class provides options for the execution cycle of the Spectrum virtual machine.</td>
    </tr>
    <tr>
      <td><a href="/kliveide/documents/scripting-vms.html#the-executioncompletionreason-enum"><code class="language-plaintext highlighter-rouge">ExecutionCompletionReason</code></a></td>
      <td>The values of this enumeration tell the reason why the virtual machine is in a paused or stopped state.</td>
    </tr>
    <tr>
      <td><a href="/kliveide/documents/scripting-audio.html#the-iaudioconfiguration-interface"><code class="language-plaintext highlighter-rouge">IAudioConfiguration</code></a></td>
      <td>This interface represents the configuration of the beeper/sound device.</td>
    </tr>
    <tr>
      <td><a href="/kliveide/documents/scripting-vms.html#the-keyboardemulator-class"><code class="language-plaintext highlighter-rouge">KeyboardEmulator</code></a></td>
      <td>This class is reserved for future extension. Right now, id does not offer any property or method for scripting.</td>
    </tr>
    <tr>
      <td><a href="/kliveide/documents/scripting-memory.html#the-memorypaginginfo-class"><code class="language-plaintext highlighter-rouge">MemoryPagingInfo</code></a></td>
      <td>This class provides properties and methods to obtain information about ROM and RAM paging.</td>
    </tr>
    <tr>
      <td><a href="/kliveide/documents/scripting-memory.html#the-memoryslice-class"><code class="language-plaintext highlighter-rouge">MemorySlice</code></a></td>
      <td>This class represents a slice of the memory in the Spectrum virtual machine.</td>
    </tr>
    <tr>
      <td><a href="/kliveide/documents/scripting-memory.html#the-readonlymemoryslice-class"><code class="language-plaintext highlighter-rouge">ReadOnlyMemorySlice</code></a></td>
      <td>This class represents a read-only slice of the memory in the Spectrum virtual machine.</td>
    </tr>
    <tr>
      <td><a href="/kliveide/documents/scripting-screen.html#the-screenbitmap-class"><code class="language-plaintext highlighter-rouge">ScreenBitmap</code></a></td>
      <td>This class represents the current screen’s pixels, including the border area.</td>
    </tr>
    <tr>
      <td><a href="/kliveide/documents/scripting-screen.html#the-screenconfiguration-class"><code class="language-plaintext highlighter-rouge">ScreenConfiguration</code></a></td>
      <td>This class represents the configuration of the virtual machine’s screen</td>
    </tr>
    <tr>
      <td><a href="/kliveide/documents/scripting-screen.html#the-screenrenderingstatus-class"><code class="language-plaintext highlighter-rouge">ScreenRenderingStatus</code></a></td>
      <td>Provides properties about the current screen rendering status of the machine</td>
    </tr>
    <tr>
      <td><a href="/kliveide/documents/scripting-screen.html#the-screenrenderingtable-class"><code class="language-plaintext highlighter-rouge">ScreenRenderingTable</code></a></td>
      <td>Represents the screen rendering table of the virtual machine.</td>
    </tr>
    <tr>
      <td><a href="/kliveide/documents/scripting-screen.html#the-screenrenderingtact-class"><code class="language-plaintext highlighter-rouge">ScreenRenderingTact</code></a></td>
      <td>Provides details about a screen rendering tact.</td>
    </tr>
    <tr>
      <td><a href="/kliveide/documents/scripting-memory.html#the-spectrummemorycontents-class"><code class="language-plaintext highlighter-rouge">SpectrumMemoryContents</code></a></td>
      <td>This class provides access to the addressable 64KBytes memory contents of the Spectrum virtual machine.</td>
    </tr>
    <tr>
      <td><a href="/kliveide/documents/scripting-vms.html#the-spectrummodels-class"><code class="language-plaintext highlighter-rouge">SpectrumModels</code></a></td>
      <td>This class is a repository of all Spectrum models and editions supported by <strong>SpectNetIde</strong>.</td>
    </tr>
    <tr>
      <td><a href="/kliveide/documents/scripting-vms.html#the-spectrumvm-class"><code class="language-plaintext highlighter-rouge">SpectrumVm</code></a></td>
      <td>This class represents a Spectrum virtual machine.</td>
    </tr>
    <tr>
      <td><a href="/kliveide/documents/scripting-vms.html#the-spectrumvmfactory-class"><code class="language-plaintext highlighter-rouge">SpectrumVmFactory</code></a></td>
      <td>This class provides methods you can use to create ZX Spectrum virtual machine instances.</td>
    </tr>
    <tr>
      <td><a href="/kliveide/documents/scripting-vms.html#the-vmstate-enum"><code class="language-plaintext highlighter-rouge">VmState</code></a></td>
      <td>The values of this enumeration show the possible states of a ZX Spectrum virtual machine.</td>
    </tr>
    <tr>
      <td><a href="/kliveide/documents/scripting-z80.html#the-z80instructionexecutioneventargs-class"><code class="language-plaintext highlighter-rouge">Z80InstructionExecutionEventArgs</code></a></td>
      <td>This class provides event arguments the the <code class="language-plaintext highlighter-rouge">OperationExecuting</code> and <code class="language-plaintext highlighter-rouge">OperationExecuted</code> events of the <code class="language-plaintext highlighter-rouge">CpuZ80</code> class</td>
    </tr>
  </tbody>
</table>


            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer  -->
    <div class="ui vertical stripe segment with-header-back">
        <footer class="ui container">
          <p>&copy; Istvan Novak, 2020</p>
        </footer>
      </div>
  
    <!-- Floating return to top button -->
    <a href="javascript:" id="return-to-top">
      <span>
        <svg width="32" height="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 10 16">
          <path d="M10 10l-1.5 1.5L5 7.75 1.5 11.5 0 10l5-5z"/>
        </svg>
      </span>
    </a>
    
    <!-- Floating go to previous button -->
    <a href="/kliveide/documents/scripting-overview#article" id="go-to-prev">
      <span>
        <svg width="32" height="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 10 16" transform="rotate(-90)">
          <path d="M10 10l-1.5 1.5L5 7.75 1.5 11.5 0 10l5-5z"/>
        </svg>
      </span>
    </a>
    
    
    <!-- Floating go to next button -->
    <a href="/kliveide/documents/scripting-vms#article" id="go-to-next">
      <span>
        <svg width="32" height="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 10 16" transform="rotate(90)">
          <path d="M10 10l-1.5 1.5L5 7.75 1.5 11.5 0 10l5-5z"/>
        </svg>
      </span>
    </a>
    

    <script>
      window.addEventListener("scroll", function(){
        var scrolled = window.pageYOffset > 50;
        document.getElementById("return-to-top").style.display = scrolled ? "block" : "none";
        var prevEl = document.getElementById("go-to-prev");
        if (prevEl) prevEl.style.display = scrolled ? "block" : "none";
        var nextEl = document.getElementById("go-to-next");
        if (nextEl) nextEl.style.display = scrolled ? "block" : "none";
      });
      var intervalId = 0;
      var $scrollButton = document.querySelector('#return-to-top');
      function scrollStep() {
        if (window.pageYOffset === 0) {
          clearInterval(intervalId);
        }
        window.scroll(0, window.pageYOffset - 50);
      }
      function scrollToTop() {
        intervalId = setInterval(scrollStep, 6.66);
      }
      $scrollButton.addEventListener('click', scrollToTop);

      function handleClick(arg) {
        var nextEl = arg.nextElementSibling;
        var extEl = arg.children[1];
        if (arg.classList.contains("expanded")) {
          arg.classList.remove("expanded");
          arg.classList.add("collapsed");
          extEl.classList.remove("expanded");
          extEl.classList.add("collapsed");
          nextEl.classList.remove("displayed")
          nextEl.classList.add("hidden")
        } else {
          arg.classList.remove("collapsed");
          arg.classList.add("expanded");
          extEl.classList.remove("collapsed");
          extEl.classList.add("expanded");
          nextEl.classList.remove("hidden")
          nextEl.classList.add("displayed")
        }
      }
    </script>

    
  </body>
</html>